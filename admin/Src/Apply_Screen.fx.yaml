Apply_Screen As screen:
    OnVisible: |-
        =Set(disp_menu, false);
        Refresh([@year_db]);
        //ドロップダウンのアイテム作成
        ClearCollect(major_type_dropdown_item,Choices([@apply_type_db].major_type));
        Collect(major_type_dropdown_item,{Value:"全て"});
        
        ClearCollect(faculty_dropdown_item,Choices([@user_db].faculty));
        Collect(faculty_dropdown_item,{Value:"全て"});

    ScreenContainer1_3 As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(250, 250, 250, 1)
        Height: =Parent.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =15
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =16
        PaddingLeft: =16
        PaddingRight: =16
        PaddingTop: =16
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Width: =Parent.Width
        ZIndex: =1

        TitleBar_12 As TitleBar_9:
            LayoutMinHeight: =640
            LayoutMinWidth: =640
            TitleBarLabel: ="各種申請"
            UserName: |-
                =LookUp(user_db,mail_address=User().Email).user_name & "　" & LookUp(user_db,mail_address=User().Email).user_id & "
                " & User().Email
            UserPermissionName: =First(Filter([@permission_db], permission_type = First(Filter([@user_db], mail_address = User().Email)).permission_type)).permission_name

        BodyContainer1_6 As groupContainer.horizontalAutoLayoutContainer:
            DropShadow: =DropShadow.None
            LayoutGap: =16
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =2
            PaddingLeft: =2
            PaddingRight: =2
            PaddingTop: =2
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            ZIndex: =2

            SidebarContainer1_4 As groupContainer.verticalAutoLayoutContainer:
                Fill: =RGBA(255, 255, 255, 1)
                FillPortions: =If(And(Apply_Screen.Size = ScreenSize.Small, Or(newMode, editMode, itemSelected)), 0, 3)
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =10
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =16
                PaddingRight: =16
                PaddingTop: =10
                Visible: =If(And(Apply_Screen.Size = ScreenSize.Small, Or(newMode, editMode, itemSelected)), false, true)
                ZIndex: =1

                NewRecordButtonBarContainer1_3 As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =44
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    NewRecordAddIcon1_3 As icon:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Color: =RGBA(0, 69, 120, 1)
                        DisabledBorderColor: =RGBA(245, 245, 245, 1)
                        DisabledColor: =RGBA(225, 223, 221, 1)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        FocusedBorderThickness: =4
                        Height: =44
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =RGBA(16, 110, 190, 1)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Icon: =Icon.Add
                        OnSelect: |-
                            =NewForm(ApplyScreenForm1); UpdateContext({ newMode: true });
                        PaddingBottom: =10
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =10
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedColor: =RGBA(16, 110, 190, 1)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        Width: =44
                        ZIndex: =1

                    NewRecordLabel1_2 As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(50, 49, 48, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        Height: =44
                        LayoutMinWidth: =30
                        Text: ="申請"
                        Width: =50
                        ZIndex: =2

                    Toggle1_3 As toggleSwitch:
                        FillPortions: =1
                        Height: =30
                        LayoutMinWidth: =30
                        OnSelect: =
                        Size: =5
                        TrueFill: =RGBA(0, 120, 212, 1)
                        Visible: =false
                        Width: =0
                        X: =417
                        Y: =178
                        ZIndex: =5

                    YearContainer As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width-NewRecordAddIcon1_3.Width-NewRecordLabel1_2.Width
                        ZIndex: =6

                        YearDropdown As dropdown:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            ChevronBackground: =RGBA(245, 245, 245, 1)
                            ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                            ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                            ChevronFill: =RGBA(50, 49, 48, 1)
                            ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                            ChevronHoverFill: =RGBA(50, 49, 48, 1)
                            Color: =RGBA(50, 49, 48, 1)
                            Default: =Year(Today())
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(161, 159, 157, 1)
                            DisabledFill: =RGBA(242, 242, 241, 0)
                            Fill: =RGBA(245, 245, 245, 1)
                            Font: =Font.'Segoe UI'
                            HoverBorderColor: =RGBA(16, 110, 190, 1)
                            HoverColor: =RGBA(50, 49, 48, 1)
                            HoverFill: =RGBA(245, 245, 245, 1)
                            Items: =Sequence(6,Year(Today())-5)
                            PaddingBottom: =5
                            PaddingLeft: =12
                            PaddingRight: =5
                            PaddingTop: =5
                            PressedBorderColor: =RGBA(16, 110, 190, 1)
                            PressedFill: =RGBA(0, 120, 212, 1)
                            SelectionColor: =RGBA(50, 49, 48, 1)
                            SelectionFill: =RGBA(0, 120, 212, 1)
                            Width: =Parent.Width-Label8.Width-10
                            ZIndex: =1

                        Label8 As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(161, 159, 157, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =Parent.Height
                            Text: ="年度"
                            Width: =70
                            ZIndex: =2

                UserPickerContainer As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =44
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    Visible: =admin_app
                    Width: =Parent.Width-32
                    ZIndex: =2

                    Apply_SearchIcon1 As icon:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(0, 69, 120, 1)
                        DisabledBorderColor: =RGBA(56, 56, 56, 1)
                        DisabledColor: =RGBA(119, 119, 119, 1)
                        Height: =44
                        Icon: =Icon.Reset
                        OnSelect: |-
                            =Reset(Apply_UseridInput1);
                            Reset(Apply_UserPicker1)
                        PaddingBottom: =10
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =10
                        Tooltip: ="名前の検索をやめる"
                        Width: =44
                        ZIndex: =2

                    Apply_UserPicker1 As combobox:
                        BorderColor: =RGBA(245, 245, 245, 1)
                        ChevronBackground: =RGBA(245, 245, 245, 1)
                        ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                        ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                        ChevronFill: =RGBA(50, 49, 48, 1)
                        ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                        ChevronHoverFill: =RGBA(50, 49, 48, 1)
                        Color: =RGBA(50, 49, 48, 1)
                        DefaultSelectedItems: |-
                            =// LookUp([@user_db], mail_address = User().Email)
                            If( !admin_app,
                                LookUp([@user_db],mail_address = User().Email),
                                !IsBlank(Apply_UseridInput1.Text),
                                LookUp([@user_db], user_id = Value(Apply_UseridInput1.Text))
                            )
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        DisabledFill: =RGBA(242, 242, 241, 0)
                        DisplayFields: =["Title","user_id"]
                        DisplayMode: |-
                            =If(
                                First(Filter([@permission_db], permission_type = First(Filter([@user_db], mail_address = User().Email)).permission_type)).admin,
                                Parent.DisplayMode,
                                DisplayMode.Disabled // 管理者以外は無効化
                            )
                        Fill: =RGBA(245, 245, 245, 1)
                        Font: =Font.'Segoe UI'
                        Height: =44
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =RGBA(50, 49, 48, 1)
                        HoverFill: =RGBA(245, 245, 245, 1)
                        InputTextPlaceholder: ="ユーザー名"
                        Items: |
                            =With(
                                {
                                    is_admin: First(Filter([@permission_db], permission_type = First(Filter([@user_db], mail_address = User().Email)).permission_type)).admin,
                                    sorted_user_db: Sort(Filter([@user_db], StartsWith(user_name, Self.SearchText),visible), user_id, SortOrder.Ascending),
                                    only_me: Filter([@user_db], mail_address = User().Email)
                                },
                                If(
                                    is_admin,
                                    sorted_user_db,
                                    only_me
                                )
                            )
                        OnChange: =Reset(ApplyGallery1)
                        OnSelect: =Reset(Apply_UseridInput1)
                        PaddingBottom: =0
                        PaddingLeft: =12
                        PaddingTop: =0
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedFill: =RGBA(0, 120, 212, 1)
                        SearchFields: =["Title"]
                        SearchItems: |-
                            =Search(With({is_admin:First(Filter([@permission_db],permission_type=First(Filter([@user_db],mail_address=User().Email)).permission_type)).admin,sorted_user_db:Sort(Filter([@user_db],StartsWith(user_name,Self.SearchText),visible),user_id,SortOrder.Ascending),only_me:Filter([@user_db],mail_address=User().Email)},If(is_admin,sorted_user_db,only_me)),Apply_UserPicker1.SearchText,Title)
                        SelectionFill: =RGBA(0, 120, 212, 1)
                        SelectMultiple: =false
                        Template: =ListItemTemplate.Double
                        Width: =(Parent.Width -Apply_SearchIcon1.Width)*3/5
                        ZIndex: =3

                    Apply_UseridInput1 As text:
                        BorderThickness: =0
                        Default: =
                        DisplayMode: |-
                            =If(
                                First(Filter([@permission_db], permission_type = First(Filter([@user_db], mail_address = User().Email)).permission_type)).admin,
                                Parent.DisplayMode,
                                DisplayMode.Disabled // 管理者以外は無効化
                            )
                        Fill: =RGBA(245, 245, 245, 1)
                        Format: =TextFormat.Number
                        Height: =44
                        HintText: ="職員番号"
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =(Parent.Width -Apply_SearchIcon1.Width-Apply_UserPicker1.Width)
                        ZIndex: =4

                RecordsListSeparator1_17 As rectangle:
                    AlignInContainer: =AlignInContainer.Stretch
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledFill: =RGBA(161, 159, 157, 1)
                    Fill: =RGBA(225, 223, 221, 1)
                    FocusedBorderThickness: =4
                    Height: =1
                    HoverFill: =RGBA(0, 120, 212, 1)
                    LayoutMinWidth: =200
                    PressedFill: =RGBA(0, 120, 212, 1)
                    ZIndex: =3

                ChooseCategoryContainer As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =4

                    ExplainContainer As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =50
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =200
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =1

                        Icon1 As icon.Filter:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Color: =RGBA(0, 69, 120, 1)
                            DisabledBorderColor: =RGBA(245, 245, 245, 1)
                            DisabledColor: =RGBA(225, 223, 221, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            FocusedBorderThickness: =4
                            Height: =50
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =RGBA(16, 110, 190, 1)
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Icon: =Icon.Filter
                            PaddingBottom: =10
                            PaddingLeft: =10
                            PaddingRight: =10
                            PaddingTop: =10
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedColor: =RGBA(16, 110, 190, 1)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Width: =50
                            ZIndex: =1

                        Label6 As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(161, 159, 157, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Text: ="検索条件"
                            ZIndex: =2

                        IconApplySortUpDown As icon.ArrowsUpDown:
                            AccessibleLabel: =Self.Tooltip
                            AlignInContainer: =AlignInContainer.Center
                            Color: =RGBA(0, 69, 120, 1)
                            Fill: =RGBA(255, 255, 255, 1)
                            FocusedBorderThickness: =4
                            Height: =40
                            HoverFill: =RGBA(0, 69, 120, 0.5)
                            Icon: =Icon.Sort
                            LayoutMinWidth: =0
                            OnSelect: |-
                                =UpdateContext({ApplySortDescending: !ApplySortDescending})
                            PaddingBottom: =10
                            PaddingLeft: =10
                            PaddingRight: =10
                            PaddingTop: =10
                            PressedFill: =RGBA(255, 255, 255, 0.3)
                            TabIndex: =0
                            Tooltip: =If(ApplySortDescending, "日付の昇順・降順を切り替えます")
                            Width: =40
                            X: =537
                            ZIndex: =3

                    RecordsListSeparator1_18 As rectangle:
                        AlignInContainer: =AlignInContainer.Stretch
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        DisabledFill: =RGBA(161, 159, 157, 1)
                        Fill: =RGBA(225, 223, 221, 1)
                        FocusedBorderThickness: =4
                        Height: =1
                        HoverFill: =RGBA(0, 120, 212, 1)
                        LayoutMinWidth: =200
                        PressedFill: =RGBA(0, 120, 212, 1)
                        ZIndex: =2

                    ApplicationTypeContainer As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =60
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =3

                        Label5_1 As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(161, 159, 157, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Text: |-
                                ="申請種別 :"
                            Width: =100
                            ZIndex: =1

                        ApplyMajorTypeComboBox As combobox:
                            AccessibleLabel: ="ヒント"
                            BorderColor: =RGBA(245, 245, 245, 1)
                            ChevronBackground: =RGBA(245, 245, 245, 1)
                            ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                            ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                            ChevronFill: =RGBA(50, 49, 48, 1)
                            ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                            ChevronHoverFill: =RGBA(50, 49, 48, 1)
                            Color: =RGBA(50, 49, 48, 1)
                            DefaultSelectedItems: =Last(major_type_dropdown_item)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(161, 159, 157, 1)
                            DisabledFill: =RGBA(242, 242, 241, 0)
                            DisplayFields: =["Value"]
                            Fill: =RGBA(245, 245, 245, 1)
                            Font: =Font.'Segoe UI'
                            HoverBorderColor: =RGBA(16, 110, 190, 1)
                            HoverColor: =RGBA(50, 49, 48, 1)
                            HoverFill: =RGBA(245, 245, 245, 1)
                            InputTextPlaceholder: =
                            IsSearchable: =false
                            Items: =major_type_dropdown_item
                            OnChange: |-
                                =//ドロップダウンのアイテム作成
                                If(Self.Selected.Value <> "全て",
                                    With({
                                        apply_type_table_type :Filter([@apply_type_db],Self.Selected.Value = major_type.Value)
                                        },
                                    ClearCollect(type_dropdown_item,Filter(apply_type_table_type,Self.Selected.Value = major_type.Value,!sub_type).type_name);
                                    Collect(type_dropdown_item,{type_name:"全て"})
                                    )
                                )
                            PressedBorderColor: =RGBA(16, 110, 190, 1)
                            PressedFill: =RGBA(0, 120, 212, 1)
                            SearchFields: =["Value"]
                            SearchItems: =[]
                            SelectionFill: =RGBA(0, 120, 212, 1)
                            SelectMultiple: =false
                            Width: =Parent.Width-Label5_1.Width-20
                            ZIndex: =2

                    TypeContainer As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =60
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Visible: =ApplyMajorTypeComboBox.Selected.Value <> "全て"
                        ZIndex: =4

                        Label12 As label:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(161, 159, 157, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Text: |-
                                ="区分 : "
                            Width: =100
                            ZIndex: =1

                        ApplyTypeComboBox As combobox:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =RGBA(245, 245, 245, 1)
                            ChevronBackground: =RGBA(245, 245, 245, 1)
                            ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                            ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                            ChevronFill: =RGBA(50, 49, 48, 1)
                            ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                            ChevronHoverFill: =RGBA(50, 49, 48, 1)
                            Color: =RGBA(50, 49, 48, 1)
                            DefaultSelectedItems: =Last(type_dropdown_item)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(161, 159, 157, 1)
                            DisabledFill: =RGBA(242, 242, 241, 0)
                            DisplayFields: =["type_name"]
                            Fill: =RGBA(245, 245, 245, 1)
                            Font: =Font.'Segoe UI'
                            HoverBorderColor: =RGBA(16, 110, 190, 1)
                            HoverColor: =RGBA(50, 49, 48, 1)
                            HoverFill: =RGBA(245, 245, 245, 1)
                            InputTextPlaceholder: =
                            IsSearchable: =false
                            Items: =type_dropdown_item
                            OnChange: |-
                                =//ドロップダウンのアイテム作成
                                If(Self.Selected.type_name = "その他特別休暇",
                                    With({
                                        apply_type_table_sub_type :Filter([@apply_type_db],ApplyMajorTypeComboBox.Selected.Value = major_type.Value,sub_type)
                                        },
                                    ClearCollect(sub_type_dropdown_item,apply_type_table_sub_type.type_name);
                                    Collect(sub_type_dropdown_item,{type_name:"全て"})
                                    )
                                )
                            PressedBorderColor: =RGBA(16, 110, 190, 1)
                            PressedFill: =RGBA(0, 120, 212, 1)
                            SearchFields: =["type_name"]
                            SearchItems: =[]
                            SelectionFill: =RGBA(0, 120, 212, 1)
                            SelectMultiple: =false
                            Width: =Parent.Width-Label12.Width-20
                            ZIndex: =2

                    SubTypeContainer As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =60
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Visible: |-
                            =If(ApplyMajorTypeComboBox.Selected.Value = "休暇願い" && ApplyTypeComboBox.Selected.type_name = "その他特別休暇",
                            true,false)
                        ZIndex: =5

                        Label12_3 As label:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(161, 159, 157, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Text: |-
                                ="小区分 : "
                            Width: =100
                            ZIndex: =1

                        ApplySubTypeComboBox As combobox:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =RGBA(245, 245, 245, 1)
                            ChevronBackground: =RGBA(245, 245, 245, 1)
                            ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                            ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                            ChevronFill: =RGBA(50, 49, 48, 1)
                            ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                            ChevronHoverFill: =RGBA(50, 49, 48, 1)
                            Color: =RGBA(50, 49, 48, 1)
                            DefaultSelectedItems: =Last(sub_type_dropdown_item)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(161, 159, 157, 1)
                            DisabledFill: =RGBA(242, 242, 241, 0)
                            DisplayFields: =["type_name"]
                            Fill: =RGBA(245, 245, 245, 1)
                            Font: =Font.'Segoe UI'
                            HoverBorderColor: =RGBA(16, 110, 190, 1)
                            HoverColor: =RGBA(50, 49, 48, 1)
                            HoverFill: =RGBA(245, 245, 245, 1)
                            InputTextPlaceholder: =
                            IsSearchable: =false
                            Items: =sub_type_dropdown_item
                            PressedBorderColor: =RGBA(16, 110, 190, 1)
                            PressedFill: =RGBA(0, 120, 212, 1)
                            SearchFields: =["type_name"]
                            SearchItems: =[]
                            SelectionFill: =RGBA(0, 120, 212, 1)
                            SelectMultiple: =false
                            Width: =Parent.Width-Label12_3.Width-20
                            ZIndex: =2

                    ApplyFacultyContainer As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =60
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =6

                        Label5_2 As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =RGBA(50, 49, 48, 1)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(161, 159, 157, 1)
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Text: |-
                                ="学部等 :"
                            Width: =100
                            ZIndex: =1

                        FacultyComboBox As combobox:
                            AccessibleLabel: ="ヒント"
                            BorderColor: =RGBA(245, 245, 245, 1)
                            ChevronBackground: =RGBA(245, 245, 245, 1)
                            ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                            ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                            ChevronFill: =RGBA(50, 49, 48, 1)
                            ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                            ChevronHoverFill: =RGBA(50, 49, 48, 1)
                            Color: =RGBA(50, 49, 48, 1)
                            DefaultSelectedItems: =Last(faculty_dropdown_item)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(161, 159, 157, 1)
                            DisabledFill: =RGBA(242, 242, 241, 0)
                            DisplayFields: =["Value"]
                            Fill: =RGBA(245, 245, 245, 1)
                            Font: =Font.'Segoe UI'
                            HoverBorderColor: =RGBA(16, 110, 190, 1)
                            HoverColor: =RGBA(50, 49, 48, 1)
                            HoverFill: =RGBA(245, 245, 245, 1)
                            InputTextPlaceholder: =
                            IsSearchable: =false
                            Items: =faculty_dropdown_item
                            PressedBorderColor: =RGBA(16, 110, 190, 1)
                            PressedFill: =RGBA(0, 120, 212, 1)
                            SearchFields: =["Value"]
                            SearchItems: =[]
                            SelectionFill: =RGBA(0, 120, 212, 1)
                            SelectMultiple: =false
                            Width: =Parent.Width-Label5_2.Width-20
                            ZIndex: =2

            GalleryListingContainer As groupContainer.verticalAutoLayoutContainer:
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =350
                LayoutMode: =LayoutMode.Auto
                ZIndex: =2

                "ApplyGallery1 As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="フィルター済み"
                    BorderColor: =RGBA(245, 245, 245, 1)
                    DelayItemLoading: =true
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =745
                    Items: |
                        =With({
                            holiday_db_table : If(
                                                //ユーザー未選択　かつ　管理者App かつ　管理者権限
                                                IsBlank(Apply_UserPicker1.Selected) && admin_app && LookUp([@permission_db], permission_type = LookUp([@user_db], mail_address=User().Email).permission_type).admin,
                                                    Filter([@holiday_db],
                                                        start_date >= Date(YearDropdown.Selected.Value,4,1),
                                                        start_date <  Date(YearDropdown.Selected.Value+1,4,1)
                                                    ),
                                                //ユーザー未選択　かつ　管理者App
                                                IsBlank(Apply_UserPicker1.Selected) && admin_app,
                                                    Filter([@holiday_db],
                                                        // 表示権限グループのみ表示
                                                        permission_group = LookUp([@permission_db], permission_type = LookUp([@user_db], mail_address=User().Email).permission_type).disp_permission_group,
                                                        start_date >= Date(YearDropdown.Selected.Value,4,1),
                                                        start_date <  Date(YearDropdown.Selected.Value+1,4,1)
                                                    )
                                                    ,
                                                    //ユーザー選択または一般App
                                                    Filter([@holiday_db],
                                                        
                                                        user_id = Apply_UserPicker1.Selected.user_id,
                                                        start_date >= Date(YearDropdown.Selected.Value,4,1),
                                                        start_date <  Date(YearDropdown.Selected.Value+1,4,1)
                                                    )
                                                ),
                            faculty_filter:If(FacultyComboBox.Selected.Value <> "全て",true,false)
                            },
                        
                            If(
                                //申請種別が「全て」の場合
                                ApplyMajorTypeComboBox.Selected.Value="全て",
                                SortByColumns(
                                Filter(holiday_db_table,
                                    If(faculty_filter,LookUp(RenameColumns([@user_db],user_id,userID),user_id = userID).faculty.Value = FacultyComboBox.Selected.Value,true)
                                )
                            ,
                        	"submit_date",
                        	If(ApplySortDescending, SortOrder.Ascending,SortOrder.Descending
                        	    )
                            ),
                            SortByColumns(
                                Filter(holiday_db_table,
                                    //申請種別が同じもの
                                    ApplyMajorTypeComboBox.Selected.Value = LookUp(RenameColumns([@apply_type_db],type_id,apply_type_id),type_id = apply_type_id).major_type.Value,
                                    //区分のフィルター
                                    //区分を任意のものでフィルター
                                    If(TypeContainer.Visible&& ((ApplyTypeComboBox.Selected.type_name<>"全て") &&(ApplyTypeComboBox.Selected.type_name<>"その他特別休暇")),
                                        LookUp(RenameColumns([@apply_type_db],type_id,apply_type_id),apply_type_id=type_id).type_name = ApplyTypeComboBox.Selected.type_name,
                                        //小区分を任意のものでフィルター
                                        If(SubTypeContainer.Visible&& (ApplySubTypeComboBox.Selected.type_name<>"全て"),
                                            LookUp(RenameColumns([@apply_type_db],type_id,apply_type_id),apply_type_id=type_id).type_name = ApplySubTypeComboBox.Selected.type_name,
                                            //小区分があるものを全表示
                                            If(SubTypeContainer.Visible && ApplySubTypeComboBox.Selected.type_name = "全て",
                                                LookUp(RenameColumns([@apply_type_db],type_id,apply_type_id),apply_type_id=type_id).sub_type,
                                                //区分が全ての場合
                                                true
                                            )
                                        )
                                    ),
                                    If(faculty_filter,LookUp(RenameColumns([@user_db],user_id,userID),user_id = userID).faculty.Value = FacultyComboBox.Selected.Value,true)
                                ),
                                "submit_date",
                        	    If(ApplySortDescending, SortOrder.Ascending,SortOrder.Descending
                        	     )
                                )
                            )
                        
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =287
                    LayoutMinWidth: =320
                    LoadingSpinner: =LoadingSpinner.Data
                    OnSelect: |-
                        =//UpdateContext({ itemSelected: true, CurrentItem: ThisItem });
                        UpdateContext({ itemSelected: true ,CurrentRecord: ThisItem});
                        If(newMode,UpdateContext({newMode:false , editMode:false}));
                    ShowScrollbar: =false
                    TemplateFill: =If(Self.IsSelected, RGBA(230, 230, 230, 1), RGBA(0, 0, 0, 0))
                    TemplatePadding: =0
                    TemplateSize: =120
                    Width: =Parent.Width
                    Y: =391
                    ZIndex: =1

                    Holiday_Gallery1_DateRange1_2 As label:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        Font: =Font.'Segoe UI'
                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                        Height: =Self.Size * 1.8
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =12
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =12
                        Text: =$"申請期間　"&Text(ThisItem.start_date,"yyyy/mm/dd")&"~"&Text(ThisItem.end_date,"yyyy/mm/dd")
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Holiday_Gallery1_Type1_2.Width
                        X: =Holiday_Gallery1_Type1_2.X
                        Y: =Holiday_Gallery1_User1_2.Y + Holiday_Gallery1_User1_2.Height + Holiday_Gallery1_SubmitDate1_2.Height
                        ZIndex: =5

                    Holiday_Gallery1_SubmitDate1_2 As label:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        Font: =Font.'Segoe UI'
                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                        Height: =Self.Size * 1.8
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =12
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =12
                        Text: =$"申請日　　{Text(ThisItem.submit_date,"yyyy/mm/dd")}"
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Holiday_Gallery1_Type1_2.Width
                        X: =Holiday_Gallery1_Type1_2.X
                        Y: =Holiday_Gallery1_User1_2.Y + Holiday_Gallery1_User1_2.Height
                        ZIndex: =6

                    Holiday_Gallery1_User1_2 As label:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        Font: =Font.'Segoe UI'
                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                        Height: =Self.Size * 1.8
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =12
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =12
                        Text: |-
                            =With(
                                {
                                    user_name: LookUp([@user_db], user_id = ThisItem.user_id).user_name,
                                    user_id: ThisItem.user_id
                                },
                                $"申請者　　{user_name}　{user_id}"
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Holiday_Gallery1_Type1_2.Width
                        X: =Holiday_Gallery1_Type1_2.X
                        Y: =Holiday_Gallery1_Type1_2.Y + Holiday_Gallery1_Type1_2.Height
                        ZIndex: =7

                    Holiday_Gallery1_Type1_2 As label:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(50, 49, 48, 1)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        Font: =Font.'Segoe UI'
                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                        Height: =Self.Size * 1.8
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =12
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =14
                        Text: |-
                            =With(
                                {
                                    apply_db_record: LookUp([@apply_type_db], ThisItem.type_id = type_id)
                                },
                                $"{apply_db_record.major_type.Value} ({apply_db_record.type_name}) #{ThisItem.ID}"
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.TemplateWidth
                        Y: =10
                        ZIndex: =8

                    Holiday_Gallery1_Separator1_2 As rectangle:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =8
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
                        ZIndex: =9

                    Holiday_Gallery1_Rectangle1_2 As rectangle:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Fill: |-
                            =With(
                                {
                                    // 休暇願い
                                    vacationRequestIds:            Filter([@apply_type_db], major_type_id = 1).type_id,
                                    // 休日出勤
                                    holidayWorkRequestIds:         Filter([@apply_type_db], major_type_id = 2).type_id,
                                    // 在宅勤務
                                    remoteWorkRequestIds:          Filter([@apply_type_db], major_type_id = 3).type_id,
                                    // 職務免除(労働あり)
                                    dutyExemptionWithWorkIds:      Filter([@apply_type_db], major_type_id = 4).type_id,
                                    // 職務免除(労働なし)
                                    dutyExemptionWithoutWorkIds:   Filter([@apply_type_db], major_type_id = 5).type_id
                                },
                                If(
                                    // 休暇願い 緑
                                    ThisItem.type_id in vacationRequestIds,
                                    Color.CornflowerBlue,
                                    // 休日出勤 赤
                                    ThisItem.type_id in holidayWorkRequestIds,
                                    Color.ForestGreen,
                                    // 在宅勤務 黄色
                                    ThisItem.type_id in remoteWorkRequestIds,
                                    Color.Gold,
                                    // 職務免除(労働あり)
                                    ThisItem.type_id in dutyExemptionWithWorkIds,
                                    Color.HotPink,
                                    // 職務免除(労働なし)
                                    ThisItem.type_id in dutyExemptionWithWorkIds,
                                    Color.LightPink,
                                    Color.Black
                                )
                            )
                            //RGBA(0, 69, 120, 1)
                        Height: =Parent.TemplateHeight - Holiday_Gallery1_Separator1_2.Height
                        OnSelect: =Select(Parent)
                        Width: =5
                        ZIndex: =10

                    Holiday_Gallery1_hanko_3 As group:
                        Height: =5
                        Width: =5
                        X: =-228
                        Y: =14
                        ZIndex: =15

                        hanko_circle_4 As circle:
                            BorderColor: =RGBA(222, 50, 10, 1)
                            BorderThickness: =2
                            DisabledFill: |
                                =
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            HoverFill: =
                            PressedFill: =
                            Visible: =ThisItem.is_check
                            Width: =50
                            X: =Parent.TemplateWidth - Self.Width - 15
                            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                            ZIndex: =1

                        hanko_label_4 As label:
                            Align: =Align.Center
                            Color: =RGBA(222, 50, 10, 1)
                            Font: =Font.Arial
                            Height: =50
                            LineHeight: =1
                            Size: =14
                            Text: =If(IsBlankOrError(ThisItem.check_id)||ThisItem.check_id=0, "不明", Index(Split(LookUp(user_db, user_id=ThisItem.check_id).user_name, "　"), 1).Value)
                            Visible: =ThisItem.is_check
                            Width: =50
                            X: =hanko_circle_4.X
                            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                            ZIndex: =2

                    Holiday_Gallery1_status_3 As group:
                        Height: =5
                        Width: =5
                        X: =40
                        Y: =40
                        ZIndex: =18

                        hanko_circle_5 As circle:
                            BorderColor: =RGBA(128, 128, 128, 1)
                            BorderThickness: =2
                            DisabledFill: |
                                =
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            HoverFill: =
                            PressedFill: =
                            Visible: =!ThisItem.is_check
                            Width: =50
                            X: =Parent.TemplateWidth - Self.Width - 15
                            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                            ZIndex: =3

                        hanko_label_5 As label:
                            Align: =Align.Center
                            Color: =RGBA(128, 128, 128, 1)
                            Font: =Font.Arial
                            Height: =50
                            LineHeight: =1
                            Size: =14
                            Text: |-
                                =//If(!ThisItem.is_check && IsBlank(ThisItem.check_id), "未", "取消")
                                If(!ThisItem.is_check && ThisItem.check_id = Blank(),"未","取消")
                            Visible: =!ThisItem.is_check
                            Width: =50
                            X: =hanko_circle_5.X
                            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                            ZIndex: =4

            RightContainer1_4 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                FillPortions: =5
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =16
                LayoutMinHeight: =100
                LayoutMinWidth: =200
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =2
                PaddingLeft: =2
                PaddingRight: =2
                PaddingTop: =2
                Visible: =If(Or(submitMode, And(Apply_Screen.Size = ScreenSize.Small, !newMode, !editMode, !itemSelected)), false, true)
                Width: =0
                ZIndex: =3

                SelectedRecordHeaderContainer1_4 As groupContainer.horizontalAutoLayoutContainer:
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =50
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =15

                    BackIconButton1_4 As icon.Add:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Color: =RGBA(0, 120, 212, 1)
                        DisabledBorderColor: =RGBA(245, 245, 245, 1)
                        DisabledColor: =RGBA(225, 223, 221, 1)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        FocusedBorderThickness: =4
                        Height: =50
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =RGBA(16, 110, 190, 1)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Icon: =Icon.ChevronLeft
                        OnSelect: |-
                            =//UpdateContext({ itemSelected: false })
                        PaddingBottom: =12
                        PaddingLeft: =12
                        PaddingRight: =12
                        PaddingTop: =12
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedColor: =RGBA(16, 110, 190, 1)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        TabIndex: =0
                        Visible: =If(Apply_Screen.Size = ScreenSize.Small, And(!editMode, !newMode, !submitMode), false)
                        Width: =50
                        ZIndex: =1

                    SelectedRecordTitle1_4 As label:
                        AlignInContainer: =AlignInContainer.Stretch
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(50, 49, 48, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        FillPortions: =1
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        LayoutMinWidth: =100
                        PaddingLeft: =30
                        Text: =If(newMode,"新規申請","申請内容詳細")
                        ZIndex: =2

                    Label14_2 As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(184, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        FillPortions: =1
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        LayoutMinWidth: =100
                        Text: ="未入力あり"
                        Visible: |-
                            =// 編集モードかつ未入力がない
                            And(!ApplyScreenForm1.Valid, Or(editMode, newMode, submitMode))
                        Width: =100
                        ZIndex: =3

                    detail_holiday_label_2 As label:
                        AlignInContainer: =AlignInContainer.Stretch
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(50, 49, 48, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        FillPortions: =1
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        LayoutMinWidth: =200
                        Size: =If(ScreenSize.Medium>=Apply_Screen.Size,10,13)
                        Text: |-
                            =With(
                                {userid : UserPickerComboBox.Selected.user_id},
                                If(newMode || editMode,
                            
                            "残年次有給休暇: "&Text(LookUp(year_db,And(userid=user_id,year = If(Month(Today())<4,Year(Today())-1,Year(Today())))).current_paid_holiday)&"日
                            "&"残夏期休暇: "&Text(LookUp(year_db,And(userid=user_id,year = If(Month(Today())<4,Year(Today())-1,Year(Today())))).summer_holiday)&"日"
                                )
                            )
                        Visible: =ApplyMajorComboBox.Selected.Value = "休暇願い"
                        Width: |
                            =400
                        ZIndex: =4

                    SubmitFormButton1_4 As icon:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Color: =RGBA(0, 120, 212, 1)
                        DisabledBorderColor: =RGBA(245, 245, 245, 1)
                        DisabledColor: =RGBA(225, 223, 221, 1)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        FocusedBorderThickness: =4
                        Height: =50
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =RGBA(16, 110, 190, 1)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Icon: =Icon.Check
                        OnSelect: |-
                            =If(
                                DateValidationError,
                                Notify("開始日は終了日よりも前に設定してください", NotificationType.Error),
                            SubmitForm(ApplyScreenForm1);
                            Set(DateValidationError, false);
                            )
                        PaddingBottom: =12
                        PaddingLeft: =12
                        PaddingRight: =12
                        PaddingTop: =12
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedColor: =RGBA(16, 110, 190, 1)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        TabIndex: =0
                        Visible: =false
                        Width: =50
                        ZIndex: =5

                    DeleteIconButton1_4 As icon:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Color: =RGBA(0, 69, 120, 1)
                        DisabledBorderColor: =RGBA(245, 245, 245, 1)
                        DisabledColor: =RGBA(225, 223, 221, 1)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        FocusedBorderThickness: =4
                        Height: =50
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =RGBA(16, 110, 190, 1)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Icon: =Icon.Check
                        OnSelect: |
                            =UpdateContext({ submitMode: true,
                                            submitModeCancelled: false,
                                            selectedRecord: ApplyGallery1.Selected
                                            });
                        PaddingBottom: =12
                        PaddingLeft: =12
                        PaddingRight: =12
                        PaddingTop: =12
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedColor: =RGBA(16, 110, 190, 1)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        TabIndex: =0
                        Visible: =Or(editMode, newMode)
                        Width: =50
                        ZIndex: =6

                    ResetFormButton1_4 As icon:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Color: =RGBA(0, 69, 120, 1)
                        DisabledBorderColor: =RGBA(245, 245, 245, 1)
                        DisabledColor: =RGBA(225, 223, 221, 1)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        FocusedBorderThickness: =4
                        Height: =50
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =RGBA(16, 110, 190, 1)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Icon: =Icon.Cancel
                        OnSelect: |-
                            =ResetForm(ApplyScreenForm1); UpdateContext({ editMode: false, newMode: false,fromCalendar:false,Holiday_StartWorkDay:Blank(),Holiday_EndWorkDay:Blank()});
                        PaddingBottom: =12
                        PaddingLeft: =12
                        PaddingRight: =12
                        PaddingTop: =12
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedColor: =RGBA(16, 110, 190, 1)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        TabIndex: =0
                        Visible: =Or(editMode, newMode)
                        Width: =50
                        ZIndex: =7

                    EditIconButton1_4 As icon:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Color: =RGBA(0, 120, 212, 1)
                        DisabledBorderColor: =RGBA(245, 245, 245, 1)
                        DisabledColor: =RGBA(225, 223, 221, 1)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        FocusedBorderThickness: =4
                        Height: =50
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =RGBA(16, 110, 190, 1)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Icon: =Icon.Edit
                        OnSelect: |-
                            =UpdateContext({ selectedRecord: ApplyGallery1.Selected, editMode: true })
                        PaddingBottom: =12
                        PaddingLeft: =12
                        PaddingRight: =12
                        PaddingTop: =12
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedColor: =RGBA(16, 110, 190, 1)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        TabIndex: =0
                        Visible: =false
                        Width: =50
                        ZIndex: =8

                MainContainer1_4 As groupContainer.verticalAutoLayoutContainer:
                    Fill: =RGBA(255, 255, 255, 1)
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =22

                    ApplyScreenForm1 As form:
                        BorderColor: =RGBA(245, 245, 245, 1)
                        DataSource: =holiday_db
                        DefaultMode: =If(newMode, FormMode.New, editMode, FormMode.Edit, FormMode.View)
                        Item: =ApplyGallery1.Selected
                        LayoutMinHeight: =250
                        LayoutMinWidth: =300
                        NumberOfColumns: =1
                        OnFailure: =Notify("保存できません。フォームにエラーがないか確認してください。", NotificationType.Error)
                        OnSuccess: |
                            =UpdateContext({
                                // CurrentItem: Self.LastSubmit,
                                editMode: false,
                                newMode: false
                            });
                            
                            Notify("申請が成功しました", NotificationType.Success)
                        Visible: |
                            =Or(!IsBlank(ApplyGallery1.Selected),newMode)
                        ZIndex: =1

                        type_id_DataCard1 As typedDataCard.numberEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="type_id"
                            Default: =ThisItem.type_id
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,type_id)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =130
                            Required: =true
                            Update: =Value(TypeIDTextEdit.Text)
                            Width: =589
                            X: =0
                            Y: =2
                            ZIndex: =1

                            DataCardKey23 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                PaddingLeft: =0
                                Text: ="申請種別"
                                Width: =Parent.Width/3
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            TypeIDTextEdit As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: |-
                                    =If(newMode,
                                        If(TypeData_1.Selected.type_name ="その他特別休暇",
                                            LookUp([@apply_type_db],TypeData2_1.Selected.type_id = type_id).type_id,
                                            fromCalendar,
                                            //振替休日のtype_id は　2
                                            2,
                                            
                                            ApplyMajorComboBox.Selected.Value = LookUp([@apply_type_db],major_type_id = 3).type_name,
                                            LookUp([@apply_type_db],major_type_id = 3).type_id,
                                            LookUp([@apply_type_db],TypeData_1.Selected.type_id = type_id).type_id
                                        ),
                                        Parent.Default
                                    )
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                Fill: =RGBA(102, 174, 229, 1)
                                Font: =Font.'Segoe UI'
                                Format: =TextFormat.Number
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Visible: =false
                                Width: =Parent.Width/3
                                X: =424
                                Y: =4
                                ZIndex: =2

                            ErrorMessage23 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =17
                                Y: =220
                                ZIndex: =3

                            StarVisible23 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey23.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey23.Y
                                ZIndex: =4

                            ApplyMajorComboBox As combobox:
                                BorderColor: =RGBA(245, 245, 245, 1)
                                ChevronBackground: =RGBA(245, 245, 245, 1)
                                ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                                ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                                ChevronFill: =RGBA(50, 49, 48, 1)
                                ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                                ChevronHoverFill: =RGBA(50, 49, 48, 1)
                                Color: =RGBA(50, 49, 48, 1)
                                DefaultSelectedItems: =If(newMode,["休暇願い"],LookUp([@apply_type_db],type_id = Parent.Default).major_type)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayFields: =["Value"]
                                DisplayMode: |-
                                    =Parent.DisplayMode
                                    /*
                                    If(
                                        First(Filter([@permission_db], permission_type = First(Filter([@user_db], mail_address = User().Email)).permission_type)).admin,
                                        Parent.DisplayMode,
                                        DisplayMode.Disabled // 管理者以外は無効化
                                    )
                                    */
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(245, 245, 245, 1)
                                IsSearchable: =false
                                Items: |-
                                    =With({
                                        user_admin:LookUp([@permission_db],permission_type = LookUp([@user_db],mail_address = User().Email).permission_type).admin
                                        },
                                        If(
                                            // ユーザーアプリまたは管理者権限がない場合
                                            !admin_app || !user_admin,
                                            Filter(Choices([@apply_type_db].major_type), Not(Value in ["職務免除(労働なし)", "職務免除(労働あり)"]), Value),
                                            Filter(Choices([@apply_type_db].major_type), Value)
                                        )
                                    )
                                     
                                OnChange: |-
                                    =Reset(TypeData_1);
                                    Reset(ApplyScreenForm_text_1_DataCardValue1);
                                    Reset(ApplyScreenForm_text_2_DataCardValue1);
                                    Reset(ApplyScreenForm_text_3_DataCardValue1);
                                    Reset(ApplyScreenForm_text_4_DataCardValue1);
                                    Reset(ApplyScreenForm_text_5_DataCardValue1);
                                    Reset(ApplyScreenForm_text_6_DataCardValue1);
                                PressedBorderColor: =RGBA(16, 110, 190, 1)
                                PressedFill: =RGBA(0, 120, 212, 1)
                                SearchFields: =["Value"]
                                SearchItems: =[]
                                SelectionFill: =RGBA(0, 120, 212, 1)
                                SelectMultiple: =false
                                Width: |
                                    =Parent.Width/3
                                X: =30
                                Y: =50
                                ZIndex: =5

                            TypeData_1 As combobox:
                                BorderColor: =RGBA(245, 245, 245, 1)
                                ChevronBackground: =RGBA(245, 245, 245, 1)
                                ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                                ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                                ChevronFill: =RGBA(50, 49, 48, 1)
                                ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                                ChevronHoverFill: =RGBA(50, 49, 48, 1)
                                Color: =RGBA(50, 49, 48, 1)
                                DefaultSelectedItems: |+
                                    =/*
                                    // 在宅勤務は小区分を大区分と同じにして非表示
                                    If(
                                        ApplyMajorComboBox.Selected.Value = LookUp([@apply_type_db],major_type_id = 3).type_name,
                                        LookUp([@apply_type_db],ApplyMajorComboBox.Selected.Value = major_type.Value)
                                    )
                                    /*
                                    /*
                                    If(newMode,
                                        If(fromCalendar,
                                            [ "振替休日","年次有給休暇", "夏季休暇","短期介護休暇", "子・孫の看護","忌引", "その他特別休暇"],
                                            ["年次有給休暇", "振替休日", "夏季休暇","短期介護休暇", "子・孫の看護","忌引", "その他特別休暇"]),
                                        If(Or(FakeTypeData1_1.Selected.Value = "結婚",FakeTypeData1_1.Selected.Value = "出産",FakeTypeData1_1.Selected.Value = "その他"),
                                        ["その他特別休暇"],
                                        [Parent.Default]
                                        )
                                    )
                                    */
                                    
                                    With({
                                        sub_type_table:Filter([@apply_type_db],ApplyMajorComboBox.Selected.Value = major_type.Value,sub_type)
                                        },
                                        If(newMode,
                                            If(fromCalendar,
                                                ["振替休日"]
                                            ),
                                            IsBlank(LookUp(sub_type_table,type_id = Parent.Default)),
                                            [LookUp([@apply_type_db],type_id = Parent.Default).type_name],
                                            ["その他特別休暇"]
                                        )
                                    )
                                    
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayFields: =["type_name"]
                                DisplayMode: =Parent.DisplayMode
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(245, 245, 245, 1)
                                IsSearchable: =false
                                Items: |
                                    =With({
                                        user_admin:LookUp([@permission_db],permission_type = LookUp([@user_db],mail_address = User().Email).permission_type).admin,
                                        type_category : Filter([@apply_type_db],ApplyMajorComboBox.Selected.Value = major_type.Value)
                                        },
                                        If( /*
                                            //管理者権限がない場合
                                            !user_admin,
                                            */
                                            //管理者権限がないかつ管理者Appでないか
                                            !admin_app || !user_admin,
                                            Filter(type_category,
                                                !sub_type,
                                                !visible_admin),
                                            Filter(type_category,
                                                !sub_type
                                            )
                                        )
                                    )
                                PressedBorderColor: =RGBA(16, 110, 190, 1)
                                PressedFill: =RGBA(0, 120, 212, 1)
                                SearchFields: =["ComplianceAssetId"]
                                SearchItems: =[]
                                SelectionFill: =RGBA(0, 120, 212, 1)
                                SelectMultiple: =false
                                Visible: |
                                    =// 在宅勤務は申請の小区分がないため非表示
                                    ApplyMajorComboBox.Selected.Value <> "在宅勤務"
                                Width: =Parent.Width/3
                                X: =30
                                Y: =144
                                ZIndex: =6

                            Label9 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Text: |-
                                    =If(
                                        //申請種別が休暇願いの場合
                                        ApplyMajorComboBox.Selected.Value = "休暇願い",
                                        "休暇の区分",
                                        ApplyMajorComboBox.Selected.Value = "休日出勤",
                                        "出勤区分",
                                        Left(ApplyMajorComboBox.Selected.Value,4) = "職務免除",
                                        "区分"
                                        )
                                Visible: |-
                                    =// 在宅勤務は申請の小区分がないため非表示
                                    ApplyMajorComboBox.Selected.Value <> "在宅勤務"
                                X: =30
                                Y: =97
                                ZIndex: =7

                            TypeData2_1 As combobox:
                                BorderColor: =RGBA(245, 245, 245, 1)
                                ChevronBackground: =RGBA(245, 245, 245, 1)
                                ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                                ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                                ChevronFill: =RGBA(50, 49, 48, 1)
                                ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                                ChevronHoverFill: =RGBA(50, 49, 48, 1)
                                Color: =RGBA(50, 49, 48, 1)
                                DefaultSelectedItems: |-
                                    =If(!newMode,
                                        //If(TypeData_1.Selected.type_name = "その他特別休暇",
                                        //   [LookUp([@apply_type_db],type_id = Parent.Default).type_name]),
                                        [LookUp([@apply_type_db],And(Parent.Default = type_id)).type_name]
                                    )
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayFields: =["type_name"]
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(245, 245, 245, 1)
                                IsSearchable: =false
                                Items: |
                                    =With({
                                        user_admin:LookUp([@permission_db],permission_type = LookUp([@user_db],mail_address = User().Email).permission_type).admin,
                                        type_category : Filter([@apply_type_db],ApplyMajorComboBox.Selected.Value = major_type.Value)
                                        },
                                        If( //管理者権限がない場合
                                            !user_admin,
                                            Filter(type_category,
                                                sub_type,
                                                !visible_admin),
                                            Filter(type_category,
                                                sub_type
                                            )
                                        )
                                    )
                                PressedBorderColor: =RGBA(16, 110, 190, 1)
                                PressedFill: =RGBA(0, 120, 212, 1)
                                SearchFields: =["type_name"]
                                SearchItems: =[]
                                SelectionFill: =RGBA(0, 120, 212, 1)
                                SelectMultiple: =false
                                Visible: |
                                    =If(newMode,
                                        TypeData_1.Selected.type_name = "その他特別休暇",
                                        LookUp([@apply_type_db],type_id = Parent.Default).sub_type
                                    )
                                Width: =Parent.Width/3
                                X: =ApplyScreenForm1.Width/2+30
                                Y: =TypeData_1.Y
                                ZIndex: =8

                            TypeDetaileText_1 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Text: ="その他特別休暇の詳細"
                                Visible: |
                                    =If(newMode,
                                        TypeData_1.Selected.type_name = "その他特別休暇",
                                        LookUp([@apply_type_db],type_id = Parent.Default).sub_type
                                    )
                                Width: =Parent.Width/3
                                X: =TypeData2_1.X
                                Y: =Label9.Y
                                ZIndex: =9

                            StarVisible3_7 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =Label9.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: |-
                                    =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit, // 在宅勤務は申請の小区分がないため非表示
                                    ApplyMajorComboBox.Selected.Value <> "在宅勤務")
                                Width: =30
                                Wrap: =false
                                Y: =Label9.Y
                                ZIndex: =10

                            StarVisible3_5 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey23.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey23.Y
                                ZIndex: =11

                            StarVisible3_6 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =type_id_DataCard1.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: |-
                                    =And(Parent.Required,
                                        Parent.DisplayMode=DisplayMode.Edit,
                                        If(newMode,
                                            TypeData_1.Selected.type_name = "その他特別休暇",
                                            IsBlank(LookUp([@apply_type_db],And(sub_type,type_id = Parent.Default)))
                                        )
                                    )
                                Width: =30
                                Wrap: =false
                                X: =TypeDetaileText_1.X-Self.Width
                                Y: =Label9.Y
                                ZIndex: =12

                            PrecautionsLable As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =25
                                Size: =10
                                Text: |-
                                    ="※一日かかる場合に限る。一日の定義は8:30~17:15であり、少しでも出勤できる場合は取得できない。"
                                Visible: =Left(ApplyMajorComboBox.Selected.Value,4) = "職務免除"
                                Width: =646
                                X: =17
                                Y: =184
                                ZIndex: =13

                        text_1_DataCard1 As typedDataCard.textualEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="text_1"
                            Default: =ThisItem.text_1
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: |-
                                =//DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,text_1)
                                If(ApplyMajorComboBox.Selected.Value = "休暇願い",
                                    "休暇の詳細",
                                    ApplyMajorComboBox.Selected.Value = "在宅勤務",
                                    "在宅勤務において行う具体的な業務内容",
                                    Or(ApplyMajorComboBox.Selected.Value = "職務免除(労働あり)",ApplyMajorComboBox.Selected.Value = "職務免除(労働なし)"),
                                    "備考欄",
                                    ApplyMajorComboBox.Selected.Value = "休日出勤",
                                    "休日出勤の詳細",
                                    "text_1"
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =160
                            MaxLength: =DataSourceInfo([@holiday_db], DataSourceInfo.MaxLength, text_1)
                            Required: =Self.Visible
                            Update: =ApplyScreenForm_text_1_DataCardValue1.Text
                            Visible: |-
                                =If(
                                    
                                    Value(TypeIDTextEdit.Text) = 2 ||//振替休日
                                    Value(TypeIDTextEdit.Text) = 9 ||//その他
                                    Value(TypeIDTextEdit.Text) = 6 ||//忌引
                                    ApplyMajorComboBox.Selected.Value <> "休暇願い",//休暇願いでない場合
                                    true,
                                    false
                                )
                            Width: =589
                            X: =0
                            Y: =3
                            ZIndex: =1

                            DataCardKey24 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =37
                                PaddingLeft: =0
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            ErrorMessage24 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =164
                                ZIndex: =2

                            StarVisible24 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                Fill: =Color.White
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey24.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey24.Y
                                ZIndex: =3

                            Label4_5 As label:
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Bold
                                Height: =37
                                Size: =12
                                Text: |-
                                    =If(Left(ApplyMajorComboBox.Selected.Value,4) = "職務免除",
                                        "記載例 
                                    ・(用務の)場所(オンライン含む)
                                    ・時間 ",
                                        Switch(
                                            LookUp([@apply_type_db],Value(TypeIDTextEdit.Text) = type_id).type_name,
                                            "振替休日", "例）入試業務 / 出張 / その他",
                                            "忌引", "例）市大 太郎（父親）葬儀場所:（住所）",
                                            "その他", "例）新型コロナ臨時休園"
                                        )
                                    )
                                Width: =Parent.Width/2
                                X: =203
                                Y: =10
                                ZIndex: =4

                            ApplyScreenForm_text_1_DataCardValue1 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =Parent.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                Font: =Font.'Segoe UI'
                                Height: =86
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                MaxLength: =Parent.MaxLength
                                Mode: =TextMode.MultiLine
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =45
                                ZIndex: =5

                        text_2_DataCard1 As typedDataCard.textualEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="text_2"
                            Default: =ThisItem.text_2
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: |-
                                =//DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,text_2)
                                If(ApplyMajorComboBox.Selected.Value = "休暇願い" ,
                                    "代替教員",
                                    ApplyMajorComboBox.Selected.Value = "在宅勤務",
                                    "在宅勤務の実施を必要とする理由",
                                    "text_2"
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            MaxLength: =DataSourceInfo([@holiday_db], DataSourceInfo.MaxLength, text_2)
                            Required: =ApplyMajorComboBox.Selected.Value = "在宅勤務"
                            Update: =ApplyScreenForm_text_2_DataCardValue1.Text
                            Visible: =Or(ApplyMajorComboBox.Selected.Value = "休暇願い",ApplyMajorComboBox.Selected.Value = "在宅勤務")
                            Width: =589
                            X: =0
                            Y: =4
                            ZIndex: =1

                            DataCardKey25 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            ApplyScreenForm_text_2_DataCardValue1 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =Parent.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                Font: =Font.'Segoe UI'
                                Height: =34
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                MaxLength: =Parent.MaxLength
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Visible: =ApplyMajorComboBox.Selected.Value = "在宅勤務"
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =45
                                ZIndex: =2

                            ErrorMessage25 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =ApplyScreenForm_text_2_DataCardValue1.Y + ApplyScreenForm_text_2_DataCardValue1.Height
                                ZIndex: =3

                            StarVisible25 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey25.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey25.Y
                                ZIndex: =4

                            Label16 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Text: |-
                                    =If(ApplyMajorComboBox.Selected.Value = "休暇願い",
                                        HelpTeacher.Selected.user_name,
                                        ApplyMajorComboBox.Selected.Value = "在宅勤務",
                                        ApplyScreenForm_text_2_DataCardValue1.Text
                                    )
                                Visible: |-
                                    =//true
                                    false
                                X: =440
                                Y: =6
                                ZIndex: =5

                            HelpTeacher As combobox:
                                BorderColor: =RGBA(245, 245, 245, 1)
                                ChevronBackground: =RGBA(245, 245, 245, 1)
                                ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                                ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                                ChevronFill: =RGBA(50, 49, 48, 1)
                                ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                                ChevronHoverFill: =RGBA(50, 49, 48, 1)
                                Color: =RGBA(50, 49, 48, 1)
                                DefaultSelectedItems: =[Parent.Default]
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayFields: =["Title"]
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(245, 245, 245, 1)
                                Items: =user_db.user_name
                                PressedBorderColor: =RGBA(16, 110, 190, 1)
                                PressedFill: =RGBA(0, 120, 212, 1)
                                SearchFields: =["Title"]
                                SearchItems: =Search(user_db.user_name,HelpTeacher.SearchText,Title)
                                SelectionFill: =RGBA(0, 120, 212, 1)
                                Visible: =ApplyMajorComboBox.Selected.Value = "休暇願い"
                                Width: =238
                                X: =33
                                Y: =40
                                ZIndex: =6

                        text_3_DataCard1 As typedDataCard.textualEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="text_3"
                            Default: =ThisItem.text_3
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: |-
                                =//DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,text_3)
                                If(ApplyMajorComboBox.Selected.Value = "在宅勤務",
                                    "大学の教育及び運営に支障がない理由",
                                    "text_3"
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            MaxLength: =DataSourceInfo([@holiday_db], DataSourceInfo.MaxLength, text_3)
                            Required: =ApplyMajorComboBox.Selected.Value = "在宅勤務"
                            Update: =ApplyScreenForm_text_3_DataCardValue1.Text
                            Visible: =ApplyMajorComboBox.Selected.Value = "在宅勤務"
                            Width: =589
                            X: =0
                            Y: =5
                            ZIndex: =1

                            DataCardKey27 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            ApplyScreenForm_text_3_DataCardValue1 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =Parent.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                MaxLength: =Parent.MaxLength
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =45
                                ZIndex: =2

                            ErrorMessage34 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =13
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =ApplyScreenForm_text_3_DataCardValue1.Y + ApplyScreenForm_text_3_DataCardValue1.Height
                                ZIndex: =3

                            StarVisible34 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey27.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey27.Y
                                ZIndex: =4

                        text_4_DataCard1 As typedDataCard.textualEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="text_4"
                            Default: =ThisItem.text_4
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: |-
                                =//DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,text_4)
                                If(ApplyMajorComboBox.Selected.Value = "在宅勤務",
                                    "所属する委員会等",
                                    "text_4"
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            MaxLength: =DataSourceInfo([@holiday_db], DataSourceInfo.MaxLength, text_4)
                            Required: =ApplyMajorComboBox.Selected.Value = "在宅勤務"
                            Update: =ApplyScreenForm_text_4_DataCardValue1.Text
                            Visible: =ApplyMajorComboBox.Selected.Value = "在宅勤務"
                            Width: =589
                            X: =0
                            Y: =6
                            ZIndex: =1

                            DataCardKey28 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            ApplyScreenForm_text_4_DataCardValue1 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =Parent.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                MaxLength: =Parent.MaxLength
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey28.Y + DataCardKey28.Height + 5
                                ZIndex: =2

                            ErrorMessage35 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =13
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =ApplyScreenForm_text_4_DataCardValue1.Y + ApplyScreenForm_text_4_DataCardValue1.Height
                                ZIndex: =3

                            StarVisible35 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey28.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey28.Y
                                ZIndex: =4

                        text_5_DataCard1 As typedDataCard.textualEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="text_5"
                            Default: =ThisItem.text_5
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: |-
                                =//DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,text_5)
                                If(ApplyMajorComboBox.Selected.Value = "在宅勤務",
                                    "特別な事情の有無",
                                    "text_5"
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =If(ToggleSpecialCircumstances.Value,120,50)
                            MaxLength: =DataSourceInfo([@holiday_db], DataSourceInfo.MaxLength, text_5)
                            Required: =ApplyMajorComboBox.Selected.Value = "在宅勤務" && ToggleSpecialCircumstances.Value
                            Update: =ApplyScreenForm_text_5_DataCardValue1.Text
                            Visible: =ApplyMajorComboBox.Selected.Value = "在宅勤務"
                            Width: =589
                            X: =0
                            Y: =7
                            ZIndex: =1

                            DataCardKey29 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            ApplyScreenForm_text_5_DataCardValue1 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =Parent.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                MaxLength: =Parent.MaxLength
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Visible: =ToggleSpecialCircumstances.Value
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =80
                                ZIndex: =2

                            ErrorMessage36 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =13
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =ApplyScreenForm_text_5_DataCardValue1.Y + ApplyScreenForm_text_5_DataCardValue1.Height
                                ZIndex: =3

                            StarVisible36 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey29.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey29.Y
                                ZIndex: =4

                            ToggleSpecialCircumstances As toggleSwitch:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =If(IsBlank(ApplyScreenForm_text_5_DataCardValue1.Text), false, true)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                FalseFill: =RGBA(96, 94, 92, 1)
                                FalseHoverFill: =RGBA(50, 49, 48, 1)
                                FalseText: ="無し"
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =33
                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                PressedBorderColor: =RGBA(0, 0, 0, 0)
                                TrueFill: =RGBA(0, 120, 212, 1)
                                TrueHoverFill: =RGBA(16, 110, 190, 1)
                                TrueText: ="有り"
                                Width: =117
                                X: =224
                                Y: =10
                                ZIndex: =5

                            Label13 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =37
                                PaddingLeft: =0
                                Text: ="上限日数を超える場合の理由"
                                Visible: =ToggleSpecialCircumstances.Value
                                Width: =Parent.Width-60
                                X: =30
                                Y: =43
                                ZIndex: =6

                        text_6_DataCard1 As typedDataCard.textualEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="text_6"
                            Default: =ThisItem.text_6
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: |-
                                =//DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,text_6)
                                If(ApplyMajorComboBox.Selected.Value = "在宅勤務",
                                    "期限までに申請できない場合、その理由",
                                    "text_6"
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            MaxLength: =DataSourceInfo([@holiday_db], DataSourceInfo.MaxLength, text_6)
                            Required: =false
                            Update: =ApplyScreenForm_text_6_DataCardValue1.Text
                            Visible: =ApplyMajorComboBox.Selected.Value = "在宅勤務"
                            Width: =589
                            X: =0
                            Y: =8
                            ZIndex: =1

                            DataCardKey30 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            ApplyScreenForm_text_6_DataCardValue1 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =Parent.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                MaxLength: =Parent.MaxLength
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =45
                                ZIndex: =2

                            ErrorMessage37 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =13
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =ApplyScreenForm_text_6_DataCardValue1.Y + ApplyScreenForm_text_6_DataCardValue1.Height
                                ZIndex: =3

                            StarVisible37 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey30.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey30.Y
                                ZIndex: =4

                        note_DataCard1_1 As typedDataCard.textualEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="note"
                            Default: =ThisItem.note
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,note)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =92
                            MaxLength: =DataSourceInfo([@holiday_db], DataSourceInfo.MaxLength, note)
                            Required: =false
                            Update: =DataCardValue21_1.Text
                            Visible: =If(And(!ThisItem.is_check,!IsBlank(ThisItem.check_id)),true,false)
                            Width: =589
                            X: =0
                            Y: =9
                            ZIndex: =1

                            DataCardKey21_1 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: |-
                                    =
                                    "コメント"
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =12
                                ZIndex: =1

                            DataCardValue21_1 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =Parent.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                MaxLength: =Parent.MaxLength
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey21_1.Y + DataCardKey21_1.Height + 5
                                ZIndex: =2

                            ErrorMessage21_1 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue21_1.Y + DataCardValue21_1.Height
                                ZIndex: =3

                            StarVisible21_1 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey21_1.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey21_1.Y
                                ZIndex: =4

                        start_holiday_work_DataCard1_1 As typedDataCard.dateEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="start_holiday_work"
                            Default: =If(newMode && fromCalendar,Holiday_StartWorkDay,ThisItem.start_holiday_work)
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,start_holiday_work)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =If(TypeData_1.Selected.type_name = "振替休日",true,false)
                            Update: |-
                                =DataCardValue19_1.SelectedDate
                                //Date(Year(DataCardValue19_1.SelectedDate),Month(DataCardValue19_1.SelectedDate),Day(DataCardValue19_1.SelectedDate))
                            Visible: |-
                                =If(
                                    Value(TypeIDTextEdit.Text) = 2,
                                    true,
                                    false
                                )
                            Width: =589
                            X: =0
                            Y: =10
                            ZIndex: =1

                            DataCardKey19_1 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: ="休日出勤開始日"
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue19_1 As datepicker:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                CalendarHeaderFill: =RGBA(16, 110, 190, 1)
                                Color: =RGBA(50, 49, 48, 1)
                                DefaultDate: =Parent.Default
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                EndYear: =Year(Today())+100
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverDateFill: =RGBA(184, 187, 184, 1)
                                IconBackground: =RGBA(0, 69, 120, 1)
                                IsEditable: =true
                                PaddingBottom: =0
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                SelectedDateFill: =RGBA(0, 120, 212, 1)
                                Size: =13
                                StartOfWeek: =StartOfWeek.Monday
                                StartYear: =1899
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey19_1.Y + DataCardKey19_1.Height + 5
                                ZIndex: =2

                            StarVisible19_1 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey19_1.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey19_1.Y
                                ZIndex: =4

                            ErrorMessage19_1 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =10
                                Text: =Parent.Error
                                Width: =458
                                Y: =82
                                ZIndex: =5

                        end_holiday_work_DataCard1_1 As typedDataCard.dateEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="end_holiday_work"
                            Default: =If(newMode && fromCalendar,Holiday_EndWorkDay,ThisItem.end_holiday_work)
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,end_holiday_work)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =If(TypeData_1.Selected.type_name = "振替休日",true,false)
                            Update: |-
                                =DataCardValue20_1.SelectedDate
                                //Date(Year(DataCardValue20_1.SelectedDate),Month(DataCardValue20_1.SelectedDate),Day(DataCardValue20_1.SelectedDate))
                            Visible: |-
                                =If(
                                    Value(TypeIDTextEdit.Text) = 2,
                                    true,
                                    false
                                )
                            Width: =589
                            X: =0
                            Y: =11
                            ZIndex: =1

                            DataCardKey20_1 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: ="休日出勤終了日"
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue20_1 As datepicker:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                CalendarHeaderFill: =RGBA(16, 110, 190, 1)
                                Color: =RGBA(50, 49, 48, 1)
                                DefaultDate: =Parent.Default
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                EndYear: =Year(Today())+100
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverDateFill: =RGBA(184, 187, 184, 1)
                                IconBackground: =RGBA(0, 69, 120, 1)
                                IsEditable: =true
                                PaddingBottom: =0
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                SelectedDateFill: =RGBA(0, 120, 212, 1)
                                Size: =13
                                StartOfWeek: =StartOfWeek.Monday
                                StartYear: =1899
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey20_1.Y + DataCardKey20_1.Height + 5
                                ZIndex: =2

                            ErrorMessage20_1 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue20_1.Y + DataCardValue20_1.Height
                                ZIndex: =3

                            StarVisible20_1 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey20_1.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey20_1.Y
                                ZIndex: =4

                        permission_group_DataCard1_1 As typedDataCard.numberEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="permission_group"
                            Default: =ThisItem.permission_group
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,permission_group)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =false
                            Update: =Value(DataCardValue13_1.Text)
                            Visible: =false
                            Width: =589
                            X: =0
                            Y: =16
                            ZIndex: =1

                            DataCardKey13_1 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: ="権限グループ"
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue13_1 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =If(newMode,UserPickerComboBox.Selected.permission_group,Parent.Default)
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =DisplayMode.View
                                Font: =Font.'Segoe UI'
                                Format: =TextFormat.Number
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey13_1.Y + DataCardKey13_1.Height + 5
                                ZIndex: =2

                            ErrorMessage13_1 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue13_1.Y + DataCardValue13_1.Height
                                ZIndex: =3

                            StarVisible13_1 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey13_1.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey13_1.Y
                                ZIndex: =4

                        タイトル_DataCard1_2 As typedDataCard.textualEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Title"
                            Default: =ThisItem.タイトル
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,タイトル)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            MaxLength: =DataSourceInfo([@holiday_db], DataSourceInfo.MaxLength, タイトル)
                            Required: =true
                            Update: =DataCardValue1_4.Text
                            Visible: =false
                            Width: =589
                            X: =0
                            Y: =17
                            ZIndex: =1

                            DataCardKey1_5 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue1_4 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: ="休暇願い"
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                MaxLength: =Parent.MaxLength
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey1_5.Y + DataCardKey1_5.Height + 5
                                ZIndex: =2

                            ErrorMessage1_4 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue1_4.Y + DataCardValue1_4.Height
                                ZIndex: =3

                            StarVisible1_4 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey1_5.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey1_5.Y
                                ZIndex: =4

                        is_check_DataCard1_2 As typedDataCard.toggleEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="is_check"
                            Default: =ThisItem.is_check
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,is_check)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =true
                            Update: =DataCardValue5_4.Value
                            Visible: =false
                            Width: =589
                            X: =0
                            Y: =18
                            ZIndex: =1

                            DataCardKey6_3 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue5_4 As toggleSwitch:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                BorderStyle: =BorderStyle.None
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =Parent.Default
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                FalseFill: =RGBA(96, 94, 92, 1)
                                FalseHoverFill: =RGBA(50, 49, 48, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                PressedBorderColor: =RGBA(0, 0, 0, 0)
                                Tooltip: =Parent.DisplayName
                                TrueFill: =RGBA(0, 120, 212, 1)
                                TrueHoverFill: =RGBA(16, 110, 190, 1)
                                X: =30
                                Y: =DataCardKey6_3.Y + DataCardKey6_3.Height + 5
                                ZIndex: =2

                            ErrorMessage6_4 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue5_4.Y + DataCardValue5_4.Height
                                ZIndex: =3

                            StarVisible6_4 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey6_3.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey6_3.Y
                                ZIndex: =4

                        user_id_DataCard1_3 As typedDataCard.numberEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="user_id"
                            Default: =ThisItem.user_id
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,user_id)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =true
                            Update: =Value(DataCardValue2_4.Text)
                            Width: =589
                            WidthFit: =false
                            X: =0
                            Y: =0
                            ZIndex: =24

                            DataCardKey2_4 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: ="職員番号"
                                Width: =Parent.Width/2
                                Wrap: =false
                                X: =Parent.Width/2
                                Y: =10
                                ZIndex: =1

                            DataCardValue2_4 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =If(newMode,UserPickerComboBox.Selected.user_id,Parent.Default)
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =DisplayMode.View
                                Font: =Font.'Segoe UI'
                                Format: =TextFormat.Number
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                LineHeight: =1
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width/3
                                X: =Parent.Width/2
                                Y: =45
                                ZIndex: =2

                            ErrorMessage2_5 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue2_4.Y + DataCardValue2_4.Height
                                ZIndex: =3

                            StarVisible2_5 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey2_4.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey2_4.Y
                                ZIndex: =4

                            Label10 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                PaddingLeft: =0
                                Text: ="教職員名"
                                X: =30
                                Y: =8
                                ZIndex: =5

                            UserPickerComboBox As combobox:
                                BorderColor: =RGBA(245, 245, 245, 1)
                                ChevronBackground: =RGBA(245, 245, 245, 1)
                                ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                                ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                                ChevronFill: =RGBA(50, 49, 48, 1)
                                ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                                ChevronHoverFill: =RGBA(50, 49, 48, 1)
                                Color: =RGBA(50, 49, 48, 1)
                                DefaultSelectedItems: |-
                                    =If( newMode && !admin_app,
                                        LookUp([@user_db], mail_address = User().Email),
                                        newMode,
                                        Apply_UserPicker1.Selected,
                                        LookUp([@user_db],user_id = Parent.Default)
                                    )
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayFields: =["Title","user_id"]
                                DisplayMode: |-
                                    =If(
                                        First(Filter([@permission_db], permission_type = First(Filter([@user_db], mail_address = User().Email)).permission_type)).admin,
                                        Parent.DisplayMode,
                                        DisplayMode.Disabled // 管理者以外は無効化
                                    )
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(245, 245, 245, 1)
                                InputTextPlaceholder: ="ユーザー名"
                                Items: |
                                    =With(
                                        {
                                            is_admin: First(Filter([@permission_db], permission_type = First(Filter([@user_db], mail_address = User().Email)).permission_type)).admin,
                                            sorted_user_db: Sort(Filter([@user_db], StartsWith(user_name, Self.SearchText),visible), user_id, SortOrder.Ascending),
                                            only_me: Filter([@user_db], mail_address = User().Email)
                                        },
                                        If(
                                            is_admin,
                                            sorted_user_db,
                                            only_me
                                        )
                                    )
                                OnChange: =
                                OnSelect: =Reset(Apply_UseridInput1)
                                PressedBorderColor: =RGBA(0, 0, 0, 0)
                                PressedFill: =RGBA(0, 120, 212, 1)
                                SearchFields: =["Title"]
                                SearchItems: |-
                                    =Search(With({is_admin:First(Filter([@permission_db],permission_type=First(Filter([@user_db],mail_address=User().Email)).permission_type)).admin,sorted_user_db:Sort(Filter([@user_db],StartsWith(user_name,Self.SearchText),visible),user_id,SortOrder.Ascending),only_me:Filter([@user_db],mail_address=User().Email)},If(is_admin,sorted_user_db,only_me)),UserPickerComboBox.SearchText,Title)
                                SelectionFill: =RGBA(0, 120, 212, 1)
                                SelectMultiple: =false
                                Template: =ListItemTemplate.Double
                                Width: =Parent.Width/3
                                X: =30
                                Y: =45
                                ZIndex: =6

                        faculty_DataCard1_4 As typedDataCard.comboBoxEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="faculty"
                            Default: =ThisItem.faculty
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,faculty)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =false
                            Update: =DataCardValue12_2.Selected
                            Width: =589
                            X: =0
                            Y: =1
                            ZIndex: =24

                            DataCardKey12_2 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: ="学部等"
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue12_2 As combobox:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                ChevronBackground: =RGBA(245, 245, 245, 1)
                                ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                                ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                                ChevronFill: =RGBA(50, 49, 48, 1)
                                ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                                ChevronHoverFill: =RGBA(50, 49, 48, 1)
                                Color: =RGBA(50, 49, 48, 1)
                                DefaultSelectedItems: |-
                                    =If(
                                        newMode,
                                        Choices(
                                            [@user_db].faculty,
                                            LookUp([@user_db], user_id = UserPickerComboBox.Selected.user_id).faculty.Value
                                        ),
                                        [Parent.Default]
                                    )
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayFields: =["Value"]
                                DisplayMode: =DisplayMode.View
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(245, 245, 245, 1)
                                Items: =Choices([@user_db].faculty)
                                PaddingLeft: |-
                                    =// If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                    10
                                PressedBorderColor: =RGBA(16, 110, 190, 1)
                                PressedFill: =RGBA(0, 120, 212, 1)
                                SearchFields: =["Value"]
                                SearchItems: =Choices(user_db.faculty,DataCardValue12_2.SearchText)
                                SelectionFill: =RGBA(0, 120, 212, 1)
                                SelectMultiple: =false
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width/3
                                X: =30
                                Y: =DataCardKey12_2.Y + DataCardKey12_2.Height + 5
                                ZIndex: =2

                            ErrorMessage12_2 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue12_2.Y + DataCardValue12_2.Height
                                ZIndex: =3

                            StarVisible12_2 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey12_2.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey12_2.Y
                                ZIndex: =4

                        submit_date_DataCard1_2 As typedDataCard.dateEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="submit_date"
                            Default: =ThisItem.submit_date
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,submit_date)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =false
                            Update: =DataCardValue7_5.SelectedDate
                            Visible: =If(newMode,false,true)
                            Width: =589
                            X: =0
                            Y: =12
                            ZIndex: =24

                            DataCardKey7_5 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: ="申請日時"
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue7_5 As datepicker:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                CalendarHeaderFill: =RGBA(16, 110, 190, 1)
                                Color: =RGBA(50, 49, 48, 1)
                                DefaultDate: =Parent.Default
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                EndYear: =Year(Today())+100
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverDateFill: =RGBA(184, 187, 184, 1)
                                IconBackground: =RGBA(0, 120, 212, 1)
                                IsEditable: =true
                                OnChange: |-
                                    =If(
                                        DataCardValue8_3.SelectedDate > DataCardValue9_3.SelectedDate,
                                        Notify("開始日は終了日よりも前に設定してください", NotificationType.Error)
                                    )
                                PaddingBottom: =0
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                SelectedDateFill: =RGBA(0, 120, 212, 1)
                                Size: =13
                                StartYear: =1899
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey7_5.Y + DataCardKey7_5.Height + 5
                                ZIndex: =2

                            ErrorMessage7_5 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue7_5.Y + DataCardValue7_5.Height
                                ZIndex: =3

                            StarVisible7_5 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey7_5.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey7_5.Y
                                ZIndex: =4

                        applicant_id_DataCard1_1 As typedDataCard.numberEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="applicant_id"
                            Default: =ThisItem.applicant_id
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,applicant_id)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =true
                            Update: =Value(DataCardValue10_1.Text)
                            Visible: =If(newMode,false,true)
                            Width: =589
                            X: =0
                            Y: =13
                            ZIndex: =24

                            DataCardKey10_1 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: ="申請者職員番号"
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue10_1 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =If(newMode,LookUp(user_db,mail_address=User().Email).user_id,Parent.Default)
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                Font: =Font.'Segoe UI'
                                Format: =TextFormat.Number
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey10_1.Y + DataCardKey10_1.Height + 5
                                ZIndex: =2

                            ErrorMessage10_2 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue10_1.Y + DataCardValue10_1.Height
                                ZIndex: =3

                            StarVisible10_2 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey10_1.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey10_1.Y
                                ZIndex: =4

                        start_date_DataCard1_2 As typedDataCard.dateEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            BorderThickness: =0
                            DataField: ="start_date"
                            Default: =If(newMode,Today(),ThisItem.start_date)
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,start_date)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =101
                            Required: =true
                            Update: |-
                                =//DateTimeValue(Text(DataCardValue8_1.SelectedDate)) + Time(0,0,0)
                                Date(Year(DataCardValue8_3.SelectedDate),Month(DataCardValue8_3.SelectedDate),Day(DataCardValue8_3.SelectedDate))
                            Visible: =true
                            Width: =589
                            X: =0
                            Y: =14
                            ZIndex: =24

                            DataCardKey8_3 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: ="開始日付"
                                Width: =Parent.Width/3
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue8_3 As datepicker:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                CalendarHeaderFill: =RGBA(16, 110, 190, 1)
                                Color: =RGBA(50, 49, 48, 1)
                                DefaultDate: =Parent.Default
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                EndYear: =Year(Today())+100
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverDateFill: =RGBA(184, 187, 184, 1)
                                IconBackground: =RGBA(0, 69, 120, 1)
                                IsEditable: =true
                                OnChange: =
                                OnSelect: |-
                                    =If(
                                        DataCardValue8_3.SelectedDate > DataCardValue9_3.SelectedDate,
                                    UpdateContext({DateValidationError:true}),
                                    UpdateContext({DateValidationError:false})
                                    )
                                PaddingBottom: =0
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                SelectedDateFill: =RGBA(0, 120, 212, 1)
                                Size: =13
                                StartOfWeek: =StartOfWeek.Monday
                                StartYear: =1899
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey8_3.Y + DataCardKey8_3.Height + 5
                                ZIndex: =2

                            ErrorMessage8_3 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: |
                                    =100
                                ZIndex: =3

                            StarVisible8_3 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey8_3.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey8_3.Y
                                ZIndex: =4

                            detail_label_1 As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                Height: =45
                                Size: =10
                                Text: |-
                                    ="※振替休日は勤務日の
                                    前4週~後8週以内で取得可能です"
                                Visible: =Value(TypeIDTextEdit.Text) = 2
                                Width: =272
                                X: =104
                                Y: =1
                                ZIndex: =5

                        end_date_DataCard1_2 As typedDataCard.dateEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="end_date"
                            Default: =If(newMode,start_date_DataCard1_2.Update,ThisItem.end_date)
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,end_date)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =true
                            Update: |-
                                =//DateTimeValue(Text(DataCardValue9_1.SelectedDate)) + Time(0,0,0)
                                Date(Year(DataCardValue9_3.SelectedDate),Month(DataCardValue9_3.SelectedDate),Day(DataCardValue9_3.SelectedDate))
                                    
                            Visible: =true
                            Width: =589
                            X: =0
                            Y: =15
                            ZIndex: =24

                            DataCardKey9_3 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: ="終了日付"
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =StarVisible9_4.Width
                                Y: =10
                                ZIndex: =1

                            DataCardValue9_3 As datepicker:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                CalendarHeaderFill: =RGBA(16, 110, 190, 1)
                                Color: =RGBA(50, 49, 48, 1)
                                DefaultDate: =Parent.Default
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                EndYear: =Year(Today())+100
                                Fill: =RGBA(245, 245, 245, 1)
                                Font: =Font.'Segoe UI'
                                HoverDateFill: =RGBA(184, 187, 184, 1)
                                IconBackground: =RGBA(0, 69, 120, 1)
                                IsEditable: =true
                                OnChange: =
                                OnSelect: |-
                                    =If(
                                        DataCardValue8_3.SelectedDate > DataCardValue9_3.SelectedDate,
                                    UpdateContext({DateValidationError:true}),
                                    UpdateContext({DateValidationError:false})
                                    )
                                PaddingBottom: =0
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                SelectedDateFill: =RGBA(0, 120, 212, 1)
                                Size: =13
                                StartOfWeek: =StartOfWeek.Monday
                                StartYear: =1899
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardKey9_3.Y + DataCardKey9_3.Height + 5
                                ZIndex: =2

                            ErrorMessage9_4 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue9_3.Y + DataCardValue9_3.Height
                                ZIndex: =3

                            StarVisible9_4 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(255, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey9_3.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey9_3.Y
                                ZIndex: =4

                        check_id_DataCard1_1 As typedDataCard.numberEditCard:
                            BorderColor: =RGBA(245, 245, 245, 1)
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="check_id"
                            Default: =ThisItem.check_id
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@holiday_db],DataSourceInfo.DisplayName,check_id)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =false
                            Update: =Value(DataCardValue11_2.Text)
                            Visible: =If(newMode,false,true)
                            Width: =589
                            X: =0
                            Y: =19
                            ZIndex: =24

                            DataCardKey11_2 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                PaddingLeft: =0
                                Text: ="承認者職員番号"
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =30
                                Y: =10
                                ZIndex: =1

                            DataCardValue11_2 As text:
                                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                Color: =RGBA(50, 49, 48, 1)
                                Default: =Parent.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                DisabledFill: =RGBA(242, 242, 241, 0)
                                DisplayMode: =Parent.DisplayMode
                                Font: =Font.'Segoe UI'
                                Format: =TextFormat.Number
                                HoverBorderColor: =RGBA(16, 110, 190, 1)
                                HoverColor: =RGBA(50, 49, 48, 1)
                                HoverFill: =RGBA(255, 255, 255, 1)
                                PaddingLeft: =5
                                PressedBorderColor: =RGBA(0, 120, 212, 1)
                                PressedColor: =RGBA(50, 49, 48, 1)
                                PressedFill: =RGBA(255, 255, 255, 1)
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Tooltip: =Parent.DisplayName
                                Width: =Parent.Width - 60
                                X: =20
                                Y: =DataCardKey11_2.Y + DataCardKey11_2.Height + 5
                                ZIndex: =2

                            ErrorMessage11_2 As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(168, 0, 0, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(168, 0, 0, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue11_2.Y + DataCardValue11_2.Height
                                ZIndex: =3

                            StarVisible11_2 As label:
                                Align: =Align.Center
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =RGBA(161, 159, 157, 1)
                                FocusedBorderThickness: =4
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Semibold
                                Height: =DataCardKey11_2.Height
                                PaddingLeft: =0
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey11_2.Y
                                ZIndex: =4

                    FormSituationText_1 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(50, 49, 48, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        FillPortions: =1
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        Height: =Parent.Height
                        Size: =20
                        Text: ="申請がありません"
                        Visible: =And(IsBlank(ApplyGallery1.Selected),!newMode)
                        Width: =Parent.Width
                        ZIndex: =3

            SubmitConfirmDialogContainer1_1 As groupContainer.verticalAutoLayoutContainer:
                FillPortions: =5
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                Visible: =If(submitMode, true, false)
                Width: =0
                ZIndex: =4

                ConfirmSubmitLabel1_1 As label:
                    Align: =Align.Center
                    AlignInContainer: =AlignInContainer.Stretch
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(50, 49, 48, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(161, 159, 157, 1)
                    FillPortions: =1
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Text: =$"{ApplyMajorComboBox.Selected.Value}の申請を行いますか?"
                    ZIndex: =25

                ConfirmSubmitButtonBarContainer1_1 As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    LayoutGap: =15
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    LayoutWrap: =true
                    ZIndex: =26

                    CancelSubmitButton1_1 As button:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        DisabledFill: =RGBA(242, 242, 241, 0)
                        Fill: =RGBA(0, 69, 120, 1)
                        Font: =Font.'Segoe UI'
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverFill: =RGBA(0, 69, 120, 0.5)
                        OnSelect: |-
                            =UpdateContext({ submitMode: false, submitModeCancelled: true })
                        PressedBorderColor: =RGBA(0, 69, 120, 1)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(16, 110, 190, 1)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: ="キャンセル"
                        ZIndex: =27

                    ConfirmSubmitButton1_1 As button:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(161, 159, 157, 1)
                        DisabledFill: =RGBA(242, 242, 241, 0)
                        Fill: =RGBA(0, 69, 120, 1)
                        Font: =Font.'Segoe UI'
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverFill: =RGBA(0, 69, 120, 0.5)
                        OnSelect: |
                            =//コンテキスト変数作成
                            //申請フォームの情報をすべて変数として格納
                            UpdateContext({submitRecord: ApplyScreenForm1.Updates});
                            
                            With(
                                {
                                    major_type: LookUp([@apply_type_db],type_id = submitRecord.type_id).major_type.Value
                                },
                                If( major_type = "休暇願い",
                                    Select(HolidayApplyFunction),
                                    major_type = "休日出勤",
                                    Select(WorkingHolidayApplyFunction),
                                    major_type = "在宅勤務",
                                    Select(WorkHomeApplyFunction),
                                    Left(LookUp([@apply_type_db],type_id = submitRecord.type_id).major_type.Value,4) = "職務免除",
                                    Select(ExemptionDutyApplyFunction)
                                )
                            )
                            
                            /*
                            //申請された休暇開始日の年度を取得
                            UpdateContext({submit_start_year:If(Or(Month(submitRecord.start_date)=1,Month(submitRecord.start_date) = 2,Month(submitRecord.start_date) = 3),
                            Year(submitRecord.start_date)-1,Year(submitRecord.start_date))});
                            
                            //申請された休暇終了日の年度を取得
                            UpdateContext({submit_end_year:If(Or(Month(submitRecord.end_date)=1,Month(submitRecord.end_date) = 2,Month(submitRecord.end_date) = 3),
                            Year(submitRecord.end_date)-1,Year(submitRecord.end_date))});
                            
                            // 今月にリセット
                            // カレンダーをリロード（DateValueが委任できないのでコレクションを利用する）
                            Refresh([@work_db]);
                            ClearCollect(MyCalendarEvents, Filter([@work_db], user_id = LookUp(user_db,User().Email = mail_address).user_id, Start >= Date(Year(submitRecord.start_holiday_work),Month(submitRecord.start_holiday_work),1), Start < DateAdd(Date(Year(submitRecord.start_holiday_work),Month(submitRecord.start_holiday_work),1), 1, TimeUnit.Months)));
                            
                            ClearCollect(MyCalendarEvents, Filter(MyCalendarEvents, DateValue(Text(Start)) >= DateValue(submitRecord.start_holiday_work), DateValue(Text(End)) <= DateValue(submitRecord.end_holiday_work),is_holiday_work = true,id_substitute_holiday=Blank()));
                            
                            
                            //Notify(CountRows(MyCalendarEvents));
                            
                            If(
                                // 編集ロック
                                LookUp(monthly_db,
                                And(user_id = Calendar_UserPicker1.Selected.user_id,
                                    year_month_date >=Date(Year(_dateSelected),Month(_dateSelected),1),
                                    year_month_date < DateAdd(Date(Year(_dateSelected),Month(_dateSelected),1),1,TimeUnit.Months))).lock,
                                Notify("提出が締め切られました。編集機能がロックされています。",NotificationType.Error),
                                DateValidationError,
                                Notify("開始日は終了日よりも前に設定してください", NotificationType.Error);
                                UpdateContext({ submitMode: false, submitCancelled: true }),
                                !(submit_start_year = submit_end_year),
                                Notify("年度をまたぐ休暇申請を行わないでください", NotificationType.Error);
                                UpdateContext({ submitMode: false, submitCancelled: true }),
                                !Form1_1.Valid,
                                Notify("未入力箇所があります.",NotificationType.Error);
                                UpdateContext({ submitMode: false, submitCancelled: true }),
                                //夏季休暇の期間チェック
                                And(submitRecord.type.Value="夏季休暇",Or(Date(submit_start_year,6,1)> submitRecord.start_date,submitRecord.end_date>=Date(submit_start_year,10,1))),
                                Notify("夏季休暇 取得期間外です",NotificationType.Error);
                                UpdateContext({ submitMode: false, submitCancelled: true }),
                                
                                    //区分が年次有給休暇の場合
                                    If(submitRecord.type.Value="年次有給休暇",
                                        //取得有給休暇数と残り有給休暇数をコンテキスト変数として取得
                                        UpdateContext(
                                            {my_current_paid_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).current_paid_holiday,
                                            my_acquisition_paid_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_paid_holiday_day});
                                        
                                        UpdateContext({submit_holidays:DateDiff(submitRecord.start_date ,submitRecord.end_date)+1});//提出された申請日数を取得
                                        UpdateContext({new_current_paid_holiday:my_current_paid_holiday-submit_holidays});//提出後の残り有給休暇日数を取得
                                        UpdateContext({new_acquisition_paid_holiday:my_acquisition_paid_holiday+submit_holidays});//提出後の取得有給休暇数を取得
                                        
                                        //new_current_holidayがマイナスの場合は，上限を超えた申請と判定し，エラーを出して終了する．そうでなければ申請し，休暇日数DBを変更する
                                        If(new_current_paid_holiday<0,
                                                Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                                UpdateContext({ submitMode: false, submitCancelled: true }),
                                            
                                                Patch(year_db,LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)),{current_paid_holiday:new_current_paid_holiday});
                                                Patch(year_db,LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)),{acquisition_paid_holiday_day:new_acquisition_paid_holiday});
                                               
                                        );
                                    );
                                    //区分が夏季休暇の場合
                                    If(submitRecord.type.Value="夏季休暇",
                                    //取得夏季休暇数と残り夏季休暇数をコンテキスト変数として取得
                                    UpdateContext(
                                            {my_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).summer_holiday,
                                            my_acquisition_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_summer_holiday_day});
                                   
                                    UpdateContext({submit_holidays:DateDiff(submitRecord.start_date ,submitRecord.end_date)+1});//提出された申請日数を取得
                                    UpdateContext({new_summer_holiday:my_summer_holiday-submit_holidays});//提出後の残り夏季休暇日数を取得
                                    UpdateContext({new_acquisition_summer_holiday:my_acquisition_summer_holiday+submit_holidays});//提出後の取得夏季休暇数を取得
                            
                                    //new_current_holidayがマイナスの場合は，上限を超えた申請と判定し，エラーを出して終了する．そうでなければ申請し，休暇日数DBを変更する
                                    If(new_summer_holiday<0,
                                            Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                            UpdateContext({ submitMode: false, submitCancelled: true }),
                                            Patch(year_db,LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)),{summer_holiday:new_summer_holiday});
                                            Patch(year_db,LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)),{acquisition_summer_holiday_day:new_acquisition_summer_holiday});
                                            );
                                    );
                                    //区分が振替休日の場合
                                    If(submitRecord.type.Value="振替休日",
                                        //休日出勤した日数と休暇申請した日を計算
                                        //休日出勤した日数は，指定された期間の内，work_db内に存在するレコードの数で計算を行う
                                        UpdateContext({submit_holidays:DateDiff(submitRecord.start_date ,submitRecord.end_date)+1});//提出された申請日数を取得
                                        UpdateContext({submit_holiday_works:CountRows(MyCalendarEvents)});
                            
                                        //前4週後8週の判定を行う
                                        UpdateContext({var_start_date:DateAdd(submitRecord.start_holiday_work,-28,TimeUnit.Days)});
                                        UpdateContext({var_end_date:DateAdd(submitRecord.end_holiday_work,56,TimeUnit.Days)});
                            
                                        //Todo:前年度の休日出勤を来年度内に取得してはいけない場合，条件式が必要
                                        /*
                                        //申請された休日出勤の年度を取得
                                        UpdateContext({holiday_work_year:If(Or(Month(submitRecord.start_holiday_work)=1,Month(submitRecord.start_holiday_work) = 2,Month(submitRecord.start_holiday_work) = 3),
                                        Year(submitRecord.start_holiday_work)-1,Year(submitRecord.start_holiday_work))});
                                        *
                                        If(submitRecord.start_date < var_start_date || submitRecord.end_date > var_end_date,
                                            Notify("休暇申請は前4週後8週の範囲内で行ってください。",NotificationType.Error);
                                            UpdateContext({ submitMode: false, submitCancelled: true }),
                                            //休日出勤した日数と申請した振替休日の日数が等しいかを確認
                                            If(
                                                submit_holiday_works = submit_holidays,
                            
                                                /*
                                                //正しい申請の場合は，振替休日に対応する出勤レコードに，振替休日取得日を記入（振替休日を取得済みにする）
                                                ForAll(MyCalendarEvents,
                                                    Patch(
                                                        work_db,
                                                        LookUp(work_db As Item,Item.ID = MyCalendarEvents[@ID]),
                                                        {start_substitute_holiday:submitRecord.start_date,end_substitute_holiday:submitRecord.end_date}
                                                    )
                                                )
                                                *
                                                UpdateContext({holiday_work_situation:true});
                                                
                                                ,
                                                //間違った申請の場合は，エラーを出して終了
                                                Notify("勤務日数と休暇申請日数が異なっています", NotificationType.Error);
                                                UpdateContext({ submitMode: false, submitCancelled: true });
                                            );
                                        );
                                    );
                            
                                If(submitMode,
                                    SubmitForm(Form1_1);
                                    Notify("申請が完了しました！", NotificationType.Success);
                                    Set(DateValidationError, false);
                                    UpdateContext( { // CurrentItem: First([@holiday_db]),
                                     //itemSelected: false,
                                     editMode: false, newMode: false, deleteMode: false ,submitMode:false,fromCalendar:false});
                                    If (holiday_work_situation,
                                        UpdateContext({holiday_ID:LookUp(SortByColumns(holiday_db,"submit_date",SortOrder.Descending),And(submitRecord.user_id = user_id , submitRecord.type.Value　= "振替休日")).ID});
                                        ForAll(MyCalendarEvents,
                                                        Patch(
                                                            work_db,
                                                            LookUp(work_db As Item,Item.ID = MyCalendarEvents[@ID]),
                                                            {id_substitute_holiday:holiday_ID}
                                                        )
                                                    )
                                    );
                                    Refresh([@year_db]);,
                                    //Notify("申請エラー",NotificationType.Error);
                                    Refresh([@year_db]);
                                );
                            );
                            */
                        PressedBorderColor: =RGBA(0, 69, 120, 1)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(16, 110, 190, 1)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: ="申請"
                        ZIndex: =28

    Button4 As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(161, 159, 157, 1)
        DisabledFill: =RGBA(242, 242, 241, 0)
        Fill: =RGBA(0, 120, 212, 1)
        Font: =Font.'Segoe UI'
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(16, 110, 190, 1)
        OnSelect: =Navigate(Apply_Screen)
        PressedBorderColor: =RGBA(0, 69, 120, 1)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(16, 110, 190, 1)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Text: ="仮画面遷移用ボタン"
        Visible: =false
        X: =138
        Y: =728
        ZIndex: =2

    HolidayApplyFunction As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(161, 159, 157, 1)
        DisabledFill: =RGBA(242, 242, 241, 0)
        Fill: =RGBA(0, 120, 212, 1)
        Font: =Font.'Segoe UI'
        Height: =28
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(16, 110, 190, 1)
        OnSelect: |
            =// 休暇申請(振替休日を含む) update 2024-10-30 ueda
            Notify("休暇申請(v01)...");
            
            // 範囲の休日出勤の日付リストを作成
            Clear(workHolidayList);
            ForAll(
                Filter(
                    [@holiday_db],
                    user_id = submitRecord.user_id,
                    end_date >= submitRecord.start_holiday_work,
                    start_date <= submitRecord.end_holiday_work,
                    is_reject = false) As holiday_record,
                ForAll(
                    Sequence(DateDiff(holiday_record.start_date, holiday_record.end_date)+1),
                    Collect(
                        workHolidayList,
                        {
                            date: DateAdd(holiday_record.start_date, ThisRecord.Value-1),
                            type_id: holiday_record.type_id,
                            ID: holiday_record.ID
                        }
                    )
                )
            );
            RemoveIf(workHolidayList, Not(type_id in [20,21,22,23,24,25]));
            
            
            //コンテキスト変数作成
            With({
                //申請された休暇開始日の年度を取得
                submit_start_year:If(Or(Month(submitRecord.start_date)=1,Month(submitRecord.start_date) = 2,Month(submitRecord.start_date) = 3),
                                    Year(submitRecord.start_date)-1,Year(submitRecord.start_date)
                                ),
                //申請された休暇終了日の年度を取得
                submit_end_year:If(Or(Month(submitRecord.end_date)=1,Month(submitRecord.end_date) = 2,Month(submitRecord.end_date) = 3),
                                    Year(submitRecord.end_date)-1,Year(submitRecord.end_date)
                                ),
                //申請された月の出勤状況取得
                MyCalendarEvents :Filter([@work_db],user_id = submitRecord.user_id,
                                        Start >= submitRecord.start_holiday_work,
                                        Start < DateAdd(submitRecord.end_holiday_work,1,TimeUnit.Days),
                                        //Endを使用すると終日のレコードと24時を超えたものを仕分けれないためStartを使用
                                        is_holiday_work = true,
                                        id_substitute_holiday=Blank()
                                        //Start >= Date(Year(submitRecord.start_holiday_work),Month(submitRecord.start_holiday_work),1),
                                        //Start < DateAdd(Date(Year(submitRecord.start_holiday_work),Month(submitRecord.start_holiday_work),1), 1, TimeUnit.Months)
                                        ),
                //申請開始日の編集ロック状況を取得
                current_start_month_lock : LookUp(monthly_db,
                                        And(user_id = submitRecord.user_id,
                                            year_month_date =Date(Year(submitRecord.start_date),Month(submitRecord.start_date),1))).lock,
                //申請終了日の編集ロック状況を取得
                current_end_month_lock : LookUp(monthly_db,
                                        And(user_id = submitRecord.user_id,
                                            year_month_date =Date(Year(submitRecord.end_date),Month(submitRecord.end_date),1))).lock,
                submit_major_type:LookUp([@apply_type_db],submitRecord.type_id = type_id).major_type.Value,
                apply_type : LookUp([@apply_type_db],submitRecord.type_id = type_id).type_name,
                current_record_apply_type :LookUp([@apply_type_db],CurrentRecord.type_id = type_id).type_name
                },
            
                // 今月にリセット
                Refresh([@work_db]);
                //ClearCollect(MyCalendarEvents, Filter([@work_db], user_id = Holiday_UserPicker1.Selected.user_id, Start >= Date(Year(submitRecord.start_holiday_work),Month(submitRecord.start_holiday_work),1), Start < DateAdd(Date(Year(submitRecord.start_holiday_work),Month(submitRecord.start_holiday_work),1), 1, TimeUnit.Months)));
            
            
                ////"要確認"
                //ClearCollect(MyCalendarEvents, Filter(MyCalendarEvents, DateValue(Text(Start)) >= DateValue(submitRecord.start_holiday_work), DateValue(Text(End)) <= DateValue(submitRecord.end_holiday_work),is_holiday_work = true,id_substitute_holiday=Blank()));
                //Notify(CountRows(MyCalendarEvents));
            
                If(
                    //エラー処理
            
                    // 編集ロック
                    current_start_month_lock || current_end_month_lock,
                    Notify("提出が締め切られました。編集機能がロックされています。",NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
                    //開始日 > 終了日を除外
                    DateValidationError,
                    Notify("開始日は終了日よりも前に設定してください", NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
                    //年度またぎの申請を除外
                    !(submit_start_year = submit_end_year),
                    Notify("年度をまたぐ休暇申請を行わないでください", NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
                    //フォームでの未入力箇所をチェック
                    !ApplyScreenForm1.Valid,
                    Notify("未入力箇所があります",NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true });,
                    //編集時に日付と区分の同時編集を拒否
                    And(editMode,!(apply_type = ApplyGallery1.Selected.type.Value),Or(!(ApplyGallery1.Selected.start_date = ApplyGallery1.Selected.start_date),!(submitRecord.end_date = ApplyGallery1.Selected.end_date))),
                    Notify("区分と日付を同時に編集しないでください",NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
                    //夏期休暇の期間チェック
                    And(apply_type="夏期休暇",Or(Date(submit_start_year,6,1)> submitRecord.start_date,submitRecord.end_date>=Date(submit_start_year,10,1))),
                    Notify("夏期休暇 取得期間外です",NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
            
                    //新規申請の場合
                    If(newMode,
                        //区分が年次有給休暇の場合
                        If(apply_type="年次有給休暇",
                            //取得有給休暇数と残り有給休暇数をコンテキスト変数として取得
                            UpdateContext(
                                {my_current_paid_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).current_paid_holiday,
                                my_acquisition_paid_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_paid_holiday_day});
                            
                            UpdateContext({submit_holidays:DateDiff(submitRecord.start_date ,submitRecord.end_date)+1});//提出された申請日数を取得
                            UpdateContext({new_current_paid_holiday:my_current_paid_holiday-submit_holidays});//提出後の残り有給休暇日数を取得
                            UpdateContext({new_acquisition_paid_holiday:my_acquisition_paid_holiday+submit_holidays});//提出後の取得有給休暇数を取得
                            
                            //new_current_holidayがマイナスの場合は，上限を超えた申請と判定し，エラーを出して終了する．そうでなければ申請し，休暇日数DBを変更する
                            If(new_current_paid_holiday<0,
                                    Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                    UpdateContext({ submitMode: false, submitCancelled: true }),
                                
                                    Patch(year_db,LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)),{current_paid_holiday:new_current_paid_holiday});
                                    Patch(year_db,LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)),{acquisition_paid_holiday_day:new_acquisition_paid_holiday});
                                
                            );
                        );
                        //区分が夏期休暇の場合
                        If(apply_type="夏期休暇",
                            
                            
                        //取得夏期休暇数と残り夏期休暇数をコンテキスト変数として取得
                        UpdateContext(
                                {my_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).summer_holiday,
                                my_acquisition_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_summer_holiday_day});
                    
                        UpdateContext({submit_holidays:DateDiff(submitRecord.start_date ,submitRecord.end_date)+1});//提出された申請日数を取得
                        UpdateContext({new_summer_holiday:my_summer_holiday-submit_holidays});//提出後の残り夏期休暇日数を取得
                        UpdateContext({new_acquisition_summer_holiday:my_acquisition_summer_holiday+submit_holidays});//提出後の取得夏期休暇数を取得
            
                        //new_current_holidayがマイナスの場合は，上限を超えた申請と判定し，エラーを出して終了する．そうでなければ申請し，休暇日数DBを変更する
                        If(new_summer_holiday<0,
                                Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                UpdateContext({ submitMode: false, submitCancelled: true }),
                                Patch(year_db,LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)),{summer_holiday:new_summer_holiday});
                                Patch(year_db,LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)),{acquisition_summer_holiday_day:new_acquisition_summer_holiday});
                                );
                        );
                        //区分が振替休日の場合
                        If(apply_type="振替休日",
                            //休日出勤した日数と休暇申請した日を計算
                            //休日出勤した日数は，指定された期間の内，work_db内に存在するレコードの数で計算を行う
                            UpdateContext({submit_holidays:DateDiff(submitRecord.start_date ,submitRecord.end_date)+1});//提出された申請日数を取得
                            UpdateContext({submit_holiday_works:CountRows(MyCalendarEvents)});
            
                            //前4週後8週の判定を行う
                            UpdateContext({var_start_date:DateAdd(submitRecord.start_holiday_work,-28,TimeUnit.Days)});
                            UpdateContext({var_end_date:DateAdd(submitRecord.end_holiday_work,56,TimeUnit.Days)});
            
                            //Todo:前年度の休日出勤を来年度内に取得してはいけない場合，条件式が必要
                            /*
                            //申請された休日出勤の年度を取得
                            UpdateContext({holiday_work_year:If(Or(Month(submitRecord.start_holiday_work)=1,Month(submitRecord.start_holiday_work) = 2,Month(submitRecord.start_holiday_work) = 3),
                            Year(submitRecord.start_holiday_work)-1,Year(submitRecord.start_holiday_work))});
                            */
                            //休日出勤日申請を2つ以上含む場合(従属関係を管理できないため不可)
                            If(CountRows(Distinct(workHolidayList, ID)) > 1,
                                Notify(
                                    $"休日出勤申請の日と2日以上重複できません(日ごとに個別申請してください)",
                                    NotificationType.Error
                                );
                                UpdateContext({ submitMode: false, submitCancelled: true })
                            );
                            If(submitRecord.start_date < var_start_date || submitRecord.end_date > var_end_date,
                                Notify("休暇申請は前4週後8週の範囲内で行ってください。",NotificationType.Error);
                                UpdateContext({ submitMode: false, submitCancelled: true }),
                                //休日出勤した日数と申請した振替休日の日数が等しいかを確認
                                If(
                                    submit_holiday_works = submit_holidays,
            
                                    /*
                                    //正しい申請の場合は，振替休日に対応する出勤レコードに，振替休日取得日を記入（振替休日を取得済みにする）
                                    ForAll(MyCalendarEvents,
                                        Patch(
                                            work_db,
                                            LookUp(work_db As Item,Item.ID = MyCalendarEvents[@ID]),
                                            {start_substitute_holiday:submitRecord.start_date,end_substitute_holiday:submitRecord.end_date}
                                        )
                                    )
                                    */
                                    UpdateContext({holiday_work_situation:true});
                                    
                                    ,
                                    //間違った申請の場合は，エラーを出して終了
                                    Notify("勤務日数と休暇申請日数が異なっています", NotificationType.Error);
                                    UpdateContext({ submitMode: false, submitCancelled: true });
                                );
                            );
                        );
                    );
            
            
                //編集での処理
                If(editMode,
                    //年次有給休暇以外(夏期休暇を除く)⇒年休
                    If(And(!(current_record_apply_type = "夏期休暇"),!(current_record_apply_type = "年次有給休暇"),apply_type = "年次有給休暇"),
                        //編集後の休暇日数取得
                        UpdateContext({submit_holidays:DateDiff(submitRecord.start_date ,submitRecord.end_date)+1});
                        //編集前の年次有給休暇取得日数及び残り日数
                        UpdateContext(
                                {my_current_paid_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).current_paid_holiday,
                                my_acquisition_paid_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_paid_holiday_day});
                        //編集後の年次有給休暇取得日数及び残り日数
                            UpdateContext({new_current_paid_holiday:my_current_paid_holiday-submit_holidays});
                            UpdateContext({new_acquisition_paid_holiday:my_acquisition_paid_holiday+submit_holidays});
                        If(new_current_paid_holiday<0,
                                Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                UpdateContext({ submitMode: false, submitCancelled: true }),
                                Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{current_paid_holiday:new_current_paid_holiday});
                                Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{acquisition_paid_holiday_day:new_acquisition_paid_holiday});
                        );
                    );
            
                    //編集前が年次有給休暇
                    If(current_record_apply_type = "年次有給休暇",
                        //編集前,編集後の休暇日数をコンテキスト変数として取得
                        UpdateContext({
                            previous_submit_holidays:DateDiff(CurrentRecord.start_date,CurrentRecord.end_date)+1,
                            submit_holidays:DateDiff(submitRecord.start_date ,submitRecord.end_date)+1});
                        //年次有給休暇⇒年次有給休暇以外（夏期休暇を除く）
                        If(And(!(apply_type = "年次有給休暇"),!(apply_type = "夏期休暇")),
                            //編集前の年次有給休暇取得日数及び残り日数
                            UpdateContext(
                                    {my_current_paid_holiday:LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)).current_paid_holiday,
                                    my_acquisition_paid_holiday:LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)).acquisition_paid_holiday_day});
                            //編集後の年次有給休暇取得日数及び残り日数
                            UpdateContext(
                                {new_current_paid_holiday:my_current_paid_holiday+previous_submit_holidays,
                                new_acquisition_paid_holiday:my_acquisition_paid_holiday-previous_submit_holidays});
                            //パッチ処理
                            Patch(year_db,LookUp(year_db,And(user_id =CurrentRecord.user_id,year = submit_start_year)),{current_paid_holiday:new_current_paid_holiday});
                            Patch(year_db,LookUp(year_db,And(user_id =CurrentRecord.user_id,year = submit_start_year)),{acquisition_paid_holiday_day:new_acquisition_paid_holiday});
                        );
                        //年次有給休暇1⇒年次有給休暇2
                        If(apply_type="年次有給休暇",
                            If(submitRecord.user_id = CurrentRecord.user_id,
                                //同じ人を編集する場合
                                //現在のレコードの情報を格納
                                UpdateContext(
                                    {my_current_paid_holiday:LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)).current_paid_holiday,
                                    my_acquisition_paid_holiday:LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)).acquisition_paid_holiday_day});
                                //年次有給休暇1,2の休暇日数を格納
                                UpdateContext(
                                    {submit_holidays:DateDiff(submitRecord.start_date,submitRecord.end_date,TimeUnit.Days)+1,
                                    selected_holidays:DateDiff(CurrentRecord.start_date,CurrentRecord.end_date,TimeUnit.Days)+1}
                                );
                                //編集後の情報を格納
                                UpdateContext(
                                    {new_current_paid_holiday:my_current_paid_holiday + selected_holidays - submit_holidays,
                                    new_acquisition_paid_holiday:my_acquisition_paid_holiday - selected_holidays + submit_holidays});
                                If(new_current_paid_holiday < 0,
                                    Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                    UpdateContext({submitMode:false,submitCancelled:true}),
                                    Patch(year_db,LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)),{current_paid_holiday:new_current_paid_holiday,acquisition_paid_holiday_day:new_acquisition_paid_holiday})
                                ),
                                //異なる人を編集する場合
                                //年次有給休暇1の方のレコード情報を格納
                                UpdateContext(
                                    {my_current_paid_holiday_pre : LookUp(year_db,And(user_id = CurrentRecord.user_id , year = submit_start_year)).current_paid_holiday,
                                    my_acquisition_paid_holiday_pre :LookUp(year_db,And(user_id = CurrentRecord.user_id , year = submit_start_year)).acquisition_paid_holiday_day});
                                //年次有給休暇2の方のレコード情報を格納
                                UpdateContext(
                                    {my_current_paid_holiday : LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).current_paid_holiday,
                                    my_acquisition_paid_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_paid_holiday_day});
                                //年次有給休暇1,2の休暇日数を格納
                                UpdateContext(
                                    {submit_holidays:DateDiff(submitRecord.start_date,submitRecord.end_date,TimeUnit.Days)+1,
                                    selected_holidays:DateDiff(CurrentRecord.start_date,CurrentRecord.end_date,TimeUnit.Days)+1});
                                //年次有給休暇1の編集後の情報を格納
                                UpdateContext(
                                    {new_current_paid_holiday_pre : my_current_paid_holiday_pre + selected_holidays,
                                    new_acquisition_paid_holiday_pre : my_acquisition_paid_holiday_pre - selected_holidays});
                                //年次有給休暇2の編集後の除法を格納
                                UpdateContext(
                                    {new_current_paid_holiday:my_current_paid_holiday - submit_holidays,
                                    new_acquisition_paid_holiday:my_acquisition_paid_holiday + submit_holidays});
                                If(new_current_paid_holiday<0,
                                    Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                    UpdateContext({submitMode:false,submitCancelled:true}),
                                    Patch(year_db,LookUp(year_db,And(user_id = CurrentRecord.user_id , year = submit_start_year)),{current_paid_holiday:new_current_paid_holiday_pre,acquisition_paid_holiday_day:new_acquisition_paid_holiday_pre});
                                    Patch(year_db,LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)),{current_paid_holiday:new_current_paid_holiday,acquisition_paid_holiday_day:new_acquisition_paid_holiday});
                                )
                            )
                        
            
            
            
                /*
                        
                            //編集前の年次有給休暇1の取得日数及び残り日数
                            UpdateContext(
                                {my_current_paid_holiday_pre:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).current_paid_holiday,
                                my_acquisition_paid_holiday_pre:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).acquisition_paid_holiday_day});
                            //編集後の年次有給休暇1の取得日数及び残り日数
                            UpdateContext(
                                {new_current_paid_holiday_pre:my_current_paid_holiday_pre+previous_submit_holidays,
                                new_acquisition_paid_holiday_pre:my_acquisition_paid_holiday_pre-previous_submit_holidays});
                            //編集前と編集後が同じ人か判別
                            If( CurrentRecord.user_id = submitRecord.user_id,
                                //同じ人の場合
                                //編集前の年次有給休暇2の取得日数及び残り日数
                                UpdateContext(
                                    {my_current_paid__holiday:new_current_paid_holiday_pre+previous_submit_holidays,
                                    my_acquisition_paid_holiday:new_acquisition_paid_holiday_pre- previous_submit_holidays});,
                                //違う人の場合
                                //編集前の年次有給休暇2の取得日数及び残り日数
                                UpdateContext(
                                    {my_current_paid__holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).current_paid_holiday,
                                    my_acquisition_paid_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_paid_holiday_day}););
                            //編集後の年次有給休暇2の取得日数及び残り日数
                            UpdateContext(
                                {new_current_paid_holiday:my_current_paid_holiday-submit_holidays,
                                new_acquisition_paid_holiday:my_acquisition_paid_holiday+submit_holidays});
                            
                            If(new_current_paid_holiday<0,
                                Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                UpdateContext({ submitMode: false, submitCancelled: true }),
                                Patch(year_db,LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)),{current_paid_holiday:new_current_paid_holiday_pre});
                                Patch(year_db,LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)),{acquisition_paid_holiday_day:new_acquisition_paid_holiday_pre});
                                
                                Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{current_paid_holiday:new_current_paid_holiday});
                                Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{acquisition_paid_holiday_day:new_acquisition_paid_holiday});
                            );
                */
                    );
            
            
                        //年次有給休暇⇒夏期休暇
                        If(apply_type="夏期休暇",
            
                            //編集前の年次有給休暇取得日数及び残り日数
                            UpdateContext(
                                    {my_current_paid_holiday:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).current_paid_holiday,
                                    my_acquisition_paid_holiday:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).acquisition_paid_holiday_day});
            
                            //編集前の夏期休暇取得日数及び残り日数
                            UpdateContext(
                                    {my_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).summer_holiday,
                                    my_acquisition_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_summer_holiday_day});
            
                            //編集後の年次有給休暇取得日数及び残り日数
                            UpdateContext({new_current_paid_holiday:my_current_paid_holiday+previous_submit_holidays});
                            UpdateContext({new_acquisition_paid_holiday:my_acquisition_paid_holiday-previous_submit_holidays});
            
                            //編集後の夏期休暇取得日数及び残り日数
                            UpdateContext({new_summer_holiday:my_summer_holiday-submit_holidays});
                            UpdateContext({new_acquisition_summer_holiday:my_acquisition_summer_holiday+submit_holidays});
            
                            If(new_summer_holiday<0,
                                    Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                    UpdateContext({ submitMode: false, submitCancelled: true }),
                                Patch(year_db,LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)),{current_paid_holiday:new_current_paid_holiday});
                                Patch(year_db,LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)),{acquisition_paid_holiday_day:new_acquisition_paid_holiday});
            
                                Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{summer_holiday:new_summer_holiday});
                                Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{acquisition_summer_holiday_day:new_acquisition_summer_holiday})
                            )
                        );
                    );
                    
                    //夏期休暇以外（年次有給休暇を除く）⇒夏期休暇
                    If(And(!( current_record_apply_type = "夏期休暇"),!( current_record_apply_type = "年次有給休暇"),apply_type = "夏期休暇"),
                        //編集後の休暇日数取得
                        UpdateContext({submit_holidays:DateDiff(submitRecord.start_date ,submitRecord.end_date)+1});
            
                        //編集前の夏期休暇取得日数及び残り日数
                        UpdateContext(
                                {my_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).summer_holiday,
                                my_acquisition_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_summer_holiday_day});
                        
                        //編集後の夏期休暇取得日数及び残り日数
                        UpdateContext(
                            {new_summer_holiday:my_summer_holiday-submit_holidays,
                            new_acquisition_summer_holiday:my_acquisition_summer_holiday+submit_holidays});
                        
                        If(new_summer_holiday<0,
                                Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                UpdateContext({ submitMode: false, submitCancelled: true }),
                                Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{summer_holiday:new_summer_holiday});
                                Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{acquisition_summer_holiday_day:new_acquisition_summer_holiday});
                        );
                    );
                        
            
                    //編集前が夏期休暇
                    If( current_record_apply_type = "夏期休暇",
                        //編集前,編集後の休暇日数をコンテキスト変数として取得
                        UpdateContext({
                            previous_submit_holidays:DateDiff( CurrentRecord.start_date, CurrentRecord.end_date)+1,
                            submit_holidays:DateDiff(submitRecord.start_date ,submitRecord.end_date)+1});
                        //夏期休暇⇒夏期休暇以外(年次有給休暇を除く)
                        If(And(!(apply_type = "年次有給休暇"),!(apply_type = "夏期休暇")),
                            //編集前の夏期休暇取得日数及び残り日数
                            UpdateContext(
                                {my_summer_holiday:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).summer_holiday,
                                my_acquisition_summer_holiday:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).acquisition_summer_holiday_day});
                            //編集後の夏期休暇取得日数及び残り日数
                            UpdateContext(
                                {new_summer_holiday:my_summer_holiday+previous_submit_holidays,
                                new_acquisition_summer_holiday:my_acquisition_summer_holiday-previous_submit_holidays});
                            //パッチ処理
                            Patch(year_db,LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)),{summer_holiday:new_summer_holiday});
                            Patch(year_db,LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)),{acquisition_summer_holiday_day:new_acquisition_summer_holiday});
                        );
                    
                        //夏期休暇1⇒夏期休暇2
                        If(apply_type="夏期休暇",
                                If(submitRecord.user_id =  CurrentRecord.user_id,
                                    //同じ人を編集する場合
                                    //現在のレコードの情報を格納
                                    UpdateContext(
                                        {my_summer_holiday:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).summer_holiday,
                                        my_acquisition_summer_holiday:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).acquisition_summer_holiday_day});
                                    //夏期休暇1,2の休暇日数を格納
                                    UpdateContext(
                                        {submit_holidays:DateDiff(submitRecord.start_date,submitRecord.end_date,TimeUnit.Days)+1,
                                        selected_holidays:DateDiff( CurrentRecord.start_date, CurrentRecord.end_date,TimeUnit.Days)+1}
                                    );
                                    //編集後の情報を格納
                                    UpdateContext(
                                        {new_current_summer_holiday:my_summer_holiday + selected_holidays - submit_holidays,
                                        new_acquisition_summer_holiday:my_acquisition_summer_holiday - selected_holidays + submit_holidays});
                                    If(new_current_summer_holiday < 0,
                                        Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                        UpdateContext({submitMode:false,submitCancelled:true}),
                                        Patch(year_db,LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)),{summer_holiday:new_current_summer_holiday,acquisition_summer_holiday_day:new_acquisition_summer_holiday})
                                    ),
                                    //異なる人を編集する場合
                                    //夏期休暇1の方のレコード情報を格納
                                    UpdateContext(
                                        {my_summer_holiday_pre : LookUp(year_db,And(user_id =  CurrentRecord.user_id , year = submit_start_year)).summer_holiday,
                                        my_acquisition_summer_holiday_pre :LookUp(year_db,And(user_id =  CurrentRecord.user_id , year = submit_start_year)).acquisition_summer_holiday_day});
                                    //夏期休暇2の方のレコード情報を格納
                                    UpdateContext(
                                        {my_summer_holiday : LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).summer_holiday,
                                        my_acquisition_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_summer_holiday_day});
                                    //夏期休暇1,2の休暇日数を格納
                                    UpdateContext(
                                        {submit_holidays:DateDiff(submitRecord.start_date,submitRecord.end_date,TimeUnit.Days)+1,
                                        selected_holidays:DateDiff( CurrentRecord.start_date, CurrentRecord.end_date,TimeUnit.Days)+1});
                                    //夏期休暇1の編集後の情報を格納
                                    UpdateContext(
                                        {new_current_summer_holiday_pre : my_summer_holiday_pre + selected_holidays,
                                        new_acquisition_summer_holiday_pre : my_acquisition_summer_holiday_pre - selected_holidays});
                                    //夏期休暇2の編集後の情報を格納
                                    UpdateContext(
                                        {new_current_summer_holiday:my_summer_holiday - submit_holidays,
                                        new_acquisition_summer_holiday:my_acquisition_summer_holiday + submit_holidays});
                                    If(new_current_summer_holiday<0,
                                        Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                        UpdateContext({submitMode:false,submitCancelled:true}),
                                        Patch(year_db,LookUp(year_db,And(user_id =  CurrentRecord.user_id , year = submit_start_year)),{summer_holiday:new_current_summer_holiday_pre,acquisition_summer_holiday_day:new_acquisition_summer_holiday_pre});
                                        Patch(year_db,LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)),{summer_holiday:new_current_summer_holiday,acquisition_summer_holiday_day:new_acquisition_summer_holiday});
                                    )
                                )
            
                        /*
                        If(apply_type = "夏期休暇",
                            //編集前の夏期休暇1の取得日数及び残り日数
                            UpdateContext(
                                {my_summer_holiday_pre:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).summer_holiday,
                                my_acquisition_summer_holiday_pre:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).acquisition_summer_holiday_day});
                            //編集後の夏期休暇1の取得日数及び残り日数
                            UpdateContext(
                                {new_summer_holiday_pre:my_summer_holiday_pre+previous_submit_holidays,
                                new_acquisition_summer_holiday_pre:my_acquisition_summer_holiday_pre-previous_submit_holidays});
            
                            If( CurrentRecord.user_id = submitRecord.user_id,
                                //同じ人の場合
                                UpdateContext(
                                    {my_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).summer_holiday+previous_submit_holidays,
                                    my_acquisition_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_summer_holiday_day-previous_submit_holidays});,
                                //編集前の夏期休暇2の取得日数及び残り日数
                                UpdateContext(
                                        {my_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).summer_holiday,
                                        my_acquisition_summer_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_summer_holiday_day});
                            );
                            
                            //編集後の夏期休暇取得日数及び残り日数
                            UpdateContext({new_summer_holiday:my_summer_holiday-submit_holidays});
                            UpdateContext({new_acquisition_summer_holiday:my_acquisition_summer_holiday+submit_holidays});
            
                            If(new_summer_holiday<0,
                                    Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                    UpdateContext({ submitMode: false, submitCancelled: true }),
                                    Patch(year_db,LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)),{summer_holiday:new_summer_holiday_pre});
                                    Patch(year_db,LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)),{acquisition_summer_holiday_day:new_acquisition_summer_holiday_pre});
            
                                    Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{summer_holiday:new_summer_holiday});
                                    Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{acquisition_summer_holiday_day:new_acquisition_summer_holiday});
                            );
            
                        */
                        );
                        
                            
            
                        //夏期休暇⇒年次有給休暇
                        If(apply_type="年次有給休暇"&& current_record_apply_type = "夏期休暇",
                        UpdateContext({
                            previous_submit_holidays:DateDiff( CurrentRecord.start_date, CurrentRecord.end_date)+1,
                            submit_holidays:DateDiff(submitRecord.start_date ,submitRecord.end_date)+1});
            
                        //編集前の夏期休暇取得日数及び残り日数
                        UpdateContext(
                                {my_summer_holiday:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).summer_holiday,
                                my_acquisition_summer_holiday:LookUp(year_db,And(user_id =  CurrentRecord.user_id,year = submit_start_year)).acquisition_summer_holiday_day});
            
                        //編集前の年次有給休暇取得日数及び残り日数
                        UpdateContext(
                                {my_current_paid_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).current_paid_holiday,
                                my_acquisition_paid_holiday:LookUp(year_db,And(user_id = submitRecord.user_id,year = submit_start_year)).acquisition_paid_holiday_day});
            
                        //編集後の夏期休暇取得日数及び残り日数
                        UpdateContext({new_summer_holiday:my_summer_holiday+previous_submit_holidays});
                        UpdateContext({new_acquisition_summer_holiday:my_acquisition_summer_holiday-previous_submit_holidays});
            
                        //編集後の年次有給休暇取得日数及び残り日数
                        UpdateContext({new_current_paid_holiday:my_current_paid_holiday-submit_holidays});
                        UpdateContext({new_acquisition_paid_holiday:my_acquisition_paid_holiday+submit_holidays});
            
                        If(new_current_paid_holiday<0,
                                Notify("申請日数が今年度の上限日数を超えています", NotificationType.Error);
                                UpdateContext({ submitMode: false, submitCancelled: true }),
                            Patch(year_db,LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)),{summer_holiday:new_summer_holiday});
                            Patch(year_db,LookUp(year_db,And(user_id = CurrentRecord.user_id,year = submit_start_year)),{acquisition_summer_holiday_day:new_acquisition_summer_holiday});
            
                            Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{current_paid_holiday:new_current_paid_holiday});
                            Patch(year_db,LookUp(year_db,And(user_id =submitRecord.user_id,year = submit_start_year)),{acquisition_paid_holiday_day:new_acquisition_paid_holiday});
                        ));
                );
                );
                If(submitMode,
                    If(editMode,
                        Patch(holiday_db, CurrentRecord,{is_check:false,check_id:Blank()}););
                    
                    SubmitForm(ApplyScreenForm1);
                    Notify("休暇申請が完了しました！", NotificationType.Success);
                    Set(DateValidationError, false);
                    UpdateContext( { //CurrentItem: First([@holiday_db]), 
                    itemSelected: false, editMode: false, newMode: false, deleteMode: false ,submitMode:false,fromCalendar:false,Holiday_StartWorkDay:Blank(),Holiday_EndWorkDay:Blank(),userID:Blank()});
                    If (holiday_work_situation,
                        With(
                            {
                                last_submit_id: Last(SortByColumns(Filter([@holiday_db], user_id = submitRecord.user_id), "ID")).ID,
                                workHolidayID: First(workHolidayList).ID
                            },
                            UpdateContext({holiday_ID:LookUp(SortByColumns(holiday_db,"submit_date",SortOrder.Descending),And(submitRecord.user_id = user_id , type_id = 2)).ID});
                            ForAll(MyCalendarEvents,
                                Patch(
                                    work_db,
                                    LookUp(work_db As Item,Item.ID = MyCalendarEvents[@ID]),
                                    {id_substitute_holiday:holiday_ID}
                                )
                            );
                            // 依存先ID
                            If(
                                CountRows(workHolidayList) > 0,
                                Patch(
                                    [@holiday_db],
                                    LookUp([@holiday_db], ID = last_submit_id),
                                    {
                                        dependent_id: workHolidayID
                                    }
                                )
                            )
                        )
                    );
                    Refresh([@year_db]);,
                    //Notify("申請エラー",NotificationType.Error);
                    Refresh([@year_db]);
                    );
                );
            
            )
        PressedBorderColor: =RGBA(0, 69, 120, 1)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(16, 110, 190, 1)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Text: ="holiday_apply_function"
        Visible: =false
        Width: =240
        X: =79
        Y: =79
        ZIndex: =3

    WorkingHolidayApplyFunction As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(161, 159, 157, 1)
        DisabledFill: =RGBA(242, 242, 241, 0)
        Fill: =RGBA(0, 120, 212, 1)
        Font: =Font.'Segoe UI'
        Height: =39
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(16, 110, 190, 1)
        OnSelect: |-
            =// 休日出勤申請 update 2024-11-01 dohi
            Notify("休日出勤申請(v02)...");
            Refresh([@monthly_db]);
            Refresh([@work_db]);
            Refresh([@holiday_db]);
            Refresh([@user_db]);
            With({
                //申請された休暇開始日の年度を取得
                submit_start_year:If(Or(Month(submitRecord.start_date)=1,Month(submitRecord.start_date) = 2,Month(submitRecord.start_date) = 3),
                                    Year(submitRecord.start_date)-1,Year(submitRecord.start_date)
                                ),
                //申請された休暇終了日の年度を取得
                submit_end_year:If(Or(Month(submitRecord.end_date)=1,Month(submitRecord.end_date) = 2,Month(submitRecord.end_date) = 3),
                                    Year(submitRecord.end_date)-1,Year(submitRecord.end_date)
                                ),
                //申請開始日の編集ロック状況を取得
                current_start_month_lock : LookUp(monthly_db,
                                        And(user_id = submitRecord.user_id,
                                            year_month_date =Date(Year(submitRecord.start_date),Month(submitRecord.start_date),1))).lock,
                //申請終了日の編集ロック状況を取得
                current_end_month_lock : LookUp(monthly_db,
                                        And(user_id = submitRecord.user_id,
                                            year_month_date =Date(Year(submitRecord.end_date),Month(submitRecord.end_date),1))).lock,
                //開始日
                start_work_holiday_date : submitRecord.start_date,
                //終了日
                end_work_holiday_date : submitRecord.end_date,
                //勤務場所※type_id　＝24だと出張
                apply_type : If(submitRecord.type_id = 24,First(Choices([@work_db].type,"出張")),First(Choices([@work_db].type,"学内"))),
                //休憩時間
                apply_user_breaktime:If(submitRecord.type_id = 24,//出張だと休憩時間は登録しない（0分）
                                            0,
                                        LookUp([@user_db],user_id = submitRecord.user_id).default_break_time = Blank(),//デフォルト休憩時間が未登録
                                            60,
                                        LookUp([@user_db],user_id = submitRecord.user_id).default_break_time//申請者のデフォルト休憩時間
                                        )
                
                
                },
                If(
                    //エラー処理
                    // 編集ロック
                    current_start_month_lock || current_end_month_lock,
                    Notify("提出が締め切られました。編集機能がロックされています。",NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
                    //出勤開始日<退勤開始日かチェック
                    DateValidationError,
                    Notify("開始日付は終了日付よりも前に設定してください。",NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
                    //年度またぎの申請を除外
                    !(submit_start_year = submit_end_year),
                    Notify("年度をまたぐ休暇申請を行わないでください", NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
                    //フォームでの未入力箇所をチェック
                    !ApplyScreenForm1.Valid,
                     Notify("未入力箇所があります",NotificationType.Error);
                     UpdateContext({ submitMode: false, submitCancelled: true }),
                    //正しく入力された場合
                    //フォームの提出
                    SubmitForm(ApplyScreenForm1);
                    //勤務分のレコードをwork_dbに追加
                    With(
                        {
                            last_submit_id: Last(SortByColumns(Filter([@holiday_db], user_id = submitRecord.user_id), "ID")).ID
                        },
                        ForAll(Sequence(DateDiff(start_work_holiday_date,end_work_holiday_date,TimeUnit.Days)+1) As Index,
                            //各レコードの作成
                            Patch([@work_db],
                            {
                                user_id : submitRecord.user_id,
                                Start : DateAdd(start_work_holiday_date,Index.Value-1,TimeUnit.Days),
                                End : DateAdd(start_work_holiday_date,Index.Value-1,TimeUnit.Days),
                                faculty : submitRecord.faculty,
                                type : apply_type,
                                Subject:submitRecord.text_1,
                                break_time:apply_user_breaktime,
            
                                reg_type : WorkDB_RegTypeDrpDown.SelectedText,
                                is_holiday_work:true,
                                id_holiday_db: last_submit_id
                            });
                            
                        )
                    );
            
                    Notify("休日出勤申請が完了しました！", NotificationType.Success);
                    UpdateContext( { //CurrentItem: First([@holiday_db]), 
                    itemSelected: false, editMode: false, newMode: false, deleteMode: false ,submitMode:false,fromCalendar:false,userID:Blank(),DateValidationError:false});        
                )
            )
        PressedBorderColor: =RGBA(0, 69, 120, 1)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(16, 110, 190, 1)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Text: ="working_holiday_apply_function"
        Visible: =false
        Width: =307
        X: =350
        Y: =73
        ZIndex: =4

    WorkHomeApplyFunction As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(161, 159, 157, 1)
        DisabledFill: =RGBA(242, 242, 241, 0)
        Fill: =RGBA(0, 120, 212, 1)
        Font: =Font.'Segoe UI'
        Height: =34
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(16, 110, 190, 1)
        OnSelect: |-
            =// 在宅勤務 update 2024-10-31 hirami
            Notify($"在宅勤務申請(v08)...");
            
            // 今日から60日後までの日付リストを作成
            Clear(next60DaysList);
            ForAll(
                Sequence(60),
                Collect(
                    next60DaysList,
                    {
                        date: DateAdd(
                            Today(),
                            ThisRecord.Value-1
                        )
                    }
                )
            );
            // 開始日付から60日後までの日付リストを作成
            Clear(startdateNext60DaysList);
            ForAll(
                Sequence(60),
                Collect(
                    startdateNext60DaysList,
                    {
                        date: DateAdd(
                            submitRecord.start_date,
                            ThisRecord.Value-1
                        )
                    }
                )
            );
            // 申請日の範囲の休日出勤の日付リストを作成
            Clear(workHolidayList);
            ForAll(
                Filter(
                    [@holiday_db],
                    user_id = submitRecord.user_id,
                    end_date >= submitRecord.start_date,
                    start_date <= submitRecord.end_date,
                    is_reject = false) As holiday_record,
                ForAll(
                    Sequence(DateDiff(holiday_record.start_date, holiday_record.end_date)+1),
                    Collect(
                        workHolidayList,
                        {
                            date: DateAdd(holiday_record.start_date, ThisRecord.Value-1),
                            type_id: holiday_record.type_id,
                            ID: holiday_record.ID
                        }
                    )
                )
            );
            RemoveIf(workHolidayList, Not(type_id in [20,21,22,23,24,25]));
            // 今日から60日後までの出勤日のリストを作成
            With(
                {
                    publicHolidayList: Filter([@public_holiday_db], is_holiday = true),
                    userRestDays: ForAll(LookUp([@user_db], user_id = submitRecord.user_id).holiday_weekday, Value(ThisRecord.Value))
                },
                ClearCollect(
                    businessDaysList,
                    RemoveIf(
                        AddColumns(
                            next60DaysList,
                            is_holiday,
                            If(
                                And(
                                    Or(// 祭日またはユーザーの休みの曜日ならis_holidayをtrueにする(※休日出勤日を除く)
                                        ThisRecord.date in publicHolidayList.date, 
                                        Weekday(ThisRecord.date) in userRestDays
                                    ),
                                    // 休日出勤日ではない
                                    Not(ThisRecord.date in workHolidayList.date)
                                ),
                                true,
                                false
                            )
                        ),
                    is_holiday = true // 休日を削除
                    )
                )
            );
            // 開始日付から60日後までの出勤日のリストを作成
            With(
                {
                    publicHolidayList: Filter([@public_holiday_db], is_holiday = true),
                    userRestDays: ForAll(LookUp([@user_db], user_id = submitRecord.user_id).holiday_weekday, Value(ThisRecord.Value))
                },
                ClearCollect(
                    startdateNextBusinessDaysList,
                    RemoveIf(
                        AddColumns(
                            startdateNext60DaysList,
                            is_holiday,
                            If(
                                And(
                                    Or(// 祭日またはユーザーの休みの曜日ならis_holidayをtrueにする(※休日出勤日を除く)
                                        ThisRecord.date in publicHolidayList.date, 
                                        Weekday(ThisRecord.date) in userRestDays
                                    ),
                                    // 休日出勤日ではない
                                    Not(ThisRecord.date in workHolidayList.date)
                                ),
                                true,
                                false
                            )
                        ),
                    is_holiday = true // 休日を削除
                    )
                )
            );
            
            Refresh([@monthly_db]);
            Refresh([@work_db]);
            Refresh([@holiday_db]);
            Refresh([@user_db]);
            With(
                {
                    // 管理者権限
                    user_admin:LookUp([@permission_db],permission_type = LookUp([@user_db],mail_address = User().Email).permission_type).admin,
                    // 申請開始日の年度
                    submit_start_year: If(
                        Month(submitRecord.start_date) in [1,2,3],
                        Year(submitRecord.start_date) - 1,
                        Year(submitRecord.start_date)
                    ),
                    // 申請終了日の年度
                    submit_end_year: If(
                        Month(submitRecord.end_date) in [1,2,3],
                        Year(submitRecord.end_date) - 1,
                        Year(submitRecord.end_date)
                    ),
                    // 申請開始日の編集ロック状況
                    start_date_month_lock: LookUp(
                        [@monthly_db],
                        user_id = submitRecord.user_id && year_month_date = Date(
                            Year(submitRecord.start_date),
                            Month(submitRecord.start_date),
                            1
                        )
                    ).lock,
                    // 申請終了日の編集ロック状況
                    end_date_month_lock: LookUp(
                        [@monthly_db],
                        user_id = submitRecord.user_id && year_month_date = Date(
                            Year(submitRecord.end_date),
                            Month(submitRecord.end_date),
                            1
                        )
                    ).lock,
                    // 今週の在宅勤務申請
                    week_application_number: Filter(
                        [@holiday_db],
                        user_id = submitRecord.user_id,
                        // 日曜日から土曜日
                        end_date >= DateAdd(
                            submitRecord.start_date,
                            -Weekday(
                                submitRecord.start_date,
                                StartOfWeek.Sunday
                            ) + 1
                        ),
                        start_date < DateAdd(
                            submitRecord.start_date,
                            -Weekday(
                                submitRecord.start_date,
                                StartOfWeek.Sunday
                            ) + 8
                        ),
                        type_id = 40,// 在宅勤務
                        is_reject = false // 却下されていない
                    ),
                    // 今月の在宅勤務申請
                    month_application_number: Filter(
                        [@holiday_db],
                        user_id = submitRecord.user_id,
                        end_date >= Date(
                            Year(submitRecord.start_date),
                            Month(submitRecord.start_date),
                            1
                        ),
                        start_date < DateAdd(
                            Date(
                                Year(submitRecord.start_date),
                                Month(submitRecord.start_date),
                                1
                            ),
                            1,
                            TimeUnit.Months
                        ),
                        type_id = 40,// 在宅勤務
                        is_reject = false // 却下されていない
                    ),
                    // ユーザーの休日情報を取得
                    holiday_weekday: ForAll(
                        LookUp(
                            [@user_db],
                            user_id = Calendar_UserPicker1.Selected.user_id
                        ).holiday_weekday,
                        Value(ThisRecord.Value)
                    ),
                    // 出勤日と重複する日数
                    overlappingBusinessDaysList: CountIf(
                        Sequence(
                            DateDiff(submitRecord.start_date, submitRecord.end_date) + 1
                        ),
                        DateAdd(submitRecord.start_date, Value - 1) in startdateNextBusinessDaysList.date
                    ),
                    // 申請日数
                    totalApplicationDays: DateDiff(submitRecord.start_date, submitRecord.end_date) + 1
                },
                If(
                    // エラー処理
                    // 過ぎた申請は管理者のみ可能
                    submitRecord.start_date < Today() && (!admin_app || !user_admin),
                    Notify(
                        "当日より前の申請は管理者を除いて申請できません",
                        NotificationType.Error
                    ),
                    // 編集ロック
                    start_date_month_lock || end_date_month_lock,
                    Notify(
                        "申請期間の月は申請が締め切られているため、申請できません",
                        NotificationType.Error
                    ),
                    // 出勤開始日 < 退勤開始日かチェック
                    DateValidationError,
                    Notify(
                        "申請の開始日付は終了日付よりも前に設定してください",
                        NotificationType.Error
                    ),
                    // 年度またぎの申請を除外
                    !(submit_start_year = submit_end_year),
                    Notify(
                        "年度を跨ぐ申請はできません",
                        NotificationType.Error
                    ),
                    // フォームでの未入力箇所をチェック
                    !ApplyScreenForm1.Valid,
                    Notify(
                        "未入力箇所があります",
                        NotificationType.Error
                    ),
                    // 理由なくして7日出勤日前
                    submitRecord.start_date < Last(FirstN(businessDaysList, 7)).date && IsBlank(submitRecord.text_6),
                    Notify(
                        $"申請期限は7日出勤日前です(期限を過ぎる場合は理由が必要です) (本日は{Last(FirstN(businessDaysList, 7)).date}以降の在宅勤務申請が申請可能です)",
                        NotificationType.Error
                    ),
                    // 申請日数と出勤日との重複に数が合わない(休日を含む場合)
                    totalApplicationDays <> overlappingBusinessDaysList,
                    Notify(
                        $"休日の在宅勤務申請はできません(休日出勤申請が必要)",
                        NotificationType.Error
                    ),
                    //休日出勤日申請を2つ以上含む場合(従属関係を管理できないため不可)
                    CountRows(Distinct(workHolidayList, ID)) > 1,
                    Notify(
                        $"休日出勤申請の日と2日以上重複できません(日ごとに個別申請してください)",
                        NotificationType.Error
                    ),
                    // 理由なくして1週間に在宅勤務申請が1日を超える
                    CountRows(week_application_number) >= 1 && IsBlank(submitRecord.text_5) ||
                    totalApplicationDays > 1 && IsBlank(submitRecord.text_5),
                    Notify(
                        "日曜日からの1週間に1日を超えて在宅勤務申請できません(理由を記入してください)",
                        NotificationType.Error
                    ),
                    // 理由なくして1ヶ月以内の在宅勤務申請が4日を超える
                    CountRows(month_application_number) >= 4 && IsBlank(submitRecord.text_5),
                    Notify(
                        "1ヶ月以内に4日を超えて在宅勤務申請できません(理由を記入してください)",
                        NotificationType.Error
                    ),
                    // 正しく入力された場合
                    // フォームの提出
                    SubmitForm(ApplyScreenForm1);
                    With(
                        {
                            last_submit_id: Last(SortByColumns(Filter([@holiday_db], user_id = submitRecord.user_id), "ID")).ID,
                            workHolidayID: First(workHolidayList).ID
                        },
                        // 勤務分のレコードをwork_dbに追加
                        ForAll(
                            Sequence(
                                DateDiff(submitRecord.start_date, submitRecord.end_date)+1
                            ) As Index,
                            // 各レコードの作成
                            With(
                                {
                                    thisDate: DateAdd(submitRecord.start_date, Index.Value-1),
                                    zaitaku: First(Choices([@work_db].type,"在宅")),
                                    kyouin: First(Choices([@work_db].reg_type,"教員"))
                                },
                                If(
                                    thisDate in workHolidayList.date,
                                    // 休日出勤日の場合は休日出勤のレコードを在宅に変更
                                    With(
                                        {
                                            nextDate: DateAdd(thisDate, 1)
                                        },
                                        Patch(
                                            [@work_db],
                                            First(Filter([@work_db], id_holiday_db = workHolidayID, Start >= thisDate, End <= nextDate)),
                                            {
                                                user_id: submitRecord.user_id,
                                                faculty: submitRecord.faculty,
                                                type: zaitaku,
                                                reg_type: kyouin,
                                                is_holiday_work: true
                                            }
                                        )
                                    ),
                                    // 平日の場合は在宅出勤レコードを追加
                                    Patch(
                                        [@work_db],
                                        {
                                            user_id: submitRecord.user_id,
                                            Start: thisDate,
                                            End: thisDate,
                                            break_time: 1, // エラーを起こさせるため
                                            faculty: submitRecord.faculty,
                                            type: zaitaku,
                                            reg_type: kyouin,
                                            is_holiday_work: false,
                                            id_holiday_db: last_submit_id
                                        }
                                    )
                                )
                            )
                        );
                        // 依存先ID
                        If(
                            CountRows(workHolidayList) > 0,
                            Patch(
                                [@holiday_db],
                                LookUp([@holiday_db], ID = last_submit_id),
                                {
                                    dependent_id: workHolidayID
                                }
                            )
                        )
                    );
                    Notify(
                        "在宅勤務申請が完了しました",
                        NotificationType.Success
                    );
                    UpdateContext(
                        {
                            itemSelected: false,
                            editMode: false,
                            newMode: false,
                            deleteMode: false,
                            submitMode: false,
                            fromCalendar: false,
                            userID: Blank(),
                            DateValidationError: false
                        }
                    )
                )
            );
            UpdateContext({submitMode: false});
        PressedBorderColor: =RGBA(0, 69, 120, 1)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(16, 110, 190, 1)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Text: ="work_home_apply_function"
        Visible: =false
        Width: =268
        X: =746
        Y: =73
        ZIndex: =5

    ExemptionDutyApplyFunction As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(161, 159, 157, 1)
        DisabledFill: =RGBA(242, 242, 241, 0)
        Fill: =RGBA(0, 120, 212, 1)
        Font: =Font.'Segoe UI'
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(16, 110, 190, 1)
        OnSelect: |-
            =// 職務免除 update 2024-10-10 ueda
            Notify("職務免除申請(v01)...");
            Refresh([@monthly_db]);
            Refresh([@work_db]);
            Refresh([@holiday_db]);
            Refresh([@user_db]);
            
            With({
                //申請された休暇開始日の年度を取得
                submit_start_year:If(Or(Month(submitRecord.start_date)=1,Month(submitRecord.start_date) = 2,Month(submitRecord.start_date) = 3),
                                    Year(submitRecord.start_date)-1,Year(submitRecord.start_date)
                                ),
                //申請された休暇終了日の年度を取得
                submit_end_year:If(Or(Month(submitRecord.end_date)=1,Month(submitRecord.end_date) = 2,Month(submitRecord.end_date) = 3),
                                    Year(submitRecord.end_date)-1,Year(submitRecord.end_date)
                                ),
                //申請開始日の編集ロック状況を取得
                current_start_month_lock : LookUp(monthly_db,
                                        And(user_id = submitRecord.user_id,
                                            year_month_date =Date(Year(submitRecord.start_date),Month(submitRecord.start_date),1))).lock,
                //申請終了日の編集ロック状況を取得
                current_end_month_lock : LookUp(monthly_db,
                                        And(user_id = submitRecord.user_id,
                                            year_month_date =Date(Year(submitRecord.end_date),Month(submitRecord.end_date),1))).lock,
                //開始日
                Start_date : submitRecord.start_date,
                //終了日
                End_date : submitRecord.end_date
            
                },
            
                If(
                    //エラー処理
                    // 編集ロック
                    current_start_month_lock || current_end_month_lock,
                    Notify("提出が締め切られました。編集機能がロックされています。",NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
                    //出勤開始日<退勤開始日かチェック
                    DateValidationError,
                    Notify("開始日付は終了日付よりも前に設定してください。",NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
                    //年度またぎの申請を除外
                    !(submit_start_year = submit_end_year),
                    Notify("年度をまたぐ休暇申請を行わないでください", NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
                    //フォームでの未入力箇所をチェック
                    !ApplyScreenForm1.Valid,
                    Notify("未入力箇所があります",NotificationType.Error);
                    UpdateContext({ submitMode: false, submitCancelled: true }),
                    // 正しく入力された場合
                    SubmitForm(ApplyScreenForm1);
                    If(LookUp([@apply_type_db],submitRecord.type_id = type_id).major_type.Value = "職務免除(労働あり)",
                        With(
                            {
                                last_submit_id: Last(SortByColumns(Filter([@holiday_db], user_id = submitRecord.user_id), "ID")).ID
                            },
                            ForAll(Sequence(DateDiff(Start_date,End_date,TimeUnit.Days)+1) As Index,
                            //各出勤レコードの作成
                            Patch([@work_db],
                            {
                                user_id : submitRecord.user_id,
                                Start : DateAdd(Start_date,Index.Value-1,TimeUnit.Days),
                                End : DateAdd(Start_date,Index.Value-1,TimeUnit.Days),
                                faculty : submitRecord.faculty,
                                type :  First(Choices([@work_db].type,"職免")),
                                break_time:If(LookUp([@user_db],user_id = submitRecord.user_id).default_break_time = Blank(),
                                    60,
                                    LookUp([@user_db],user_id = submitRecord.user_id).default_break_time
                                    ),
                                is_holiday_work:false,
                                reg_type : WorkDB_RegTypeDrpDown.SelectedText,
                                id_holiday_db: last_submit_id
                            });
                            )
                        )
                    );
                    Notify("職務免除申請が完了しました！", NotificationType.Success);
                    UpdateContext( { //CurrentItem: First([@holiday_db]), 
                    itemSelected: false, editMode: false, newMode: false, deleteMode: false ,submitMode:false,fromCalendar:false,userID:Blank(),DateValidationError:false});
                )
            
            )
        PressedBorderColor: =RGBA(0, 69, 120, 1)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(16, 110, 190, 1)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Text: ="exemption_duty_apply_function"
        Visible: =false
        Width: =319
        X: =1041
        Y: =67
        ZIndex: =6

    WorkDB_TypeDropDown As dropdown:
        BorderColor: =RGBA(245, 245, 245, 1)
        ChevronBackground: =RGBA(245, 245, 245, 1)
        ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
        ChevronDisabledFill: =RGBA(161, 159, 157, 1)
        ChevronFill: =RGBA(50, 49, 48, 1)
        ChevronHoverBackground: =RGBA(245, 245, 245, 1)
        ChevronHoverFill: =RGBA(50, 49, 48, 1)
        Color: =RGBA(50, 49, 48, 1)
        Default: =If(Left(ApplyMajorComboBox.Selected.Value,4) <> "職務免除","学内","学外")
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(161, 159, 157, 1)
        DisabledFill: =RGBA(242, 242, 241, 0)
        Fill: =RGBA(245, 245, 245, 1)
        Font: =Font.'Segoe UI'
        HoverBorderColor: =RGBA(16, 110, 190, 1)
        HoverColor: =RGBA(50, 49, 48, 1)
        HoverFill: =RGBA(245, 245, 245, 1)
        Items: =Choices([@work_db].type)
        PaddingBottom: =5
        PaddingLeft: =12
        PaddingRight: =5
        PaddingTop: =5
        PressedBorderColor: =RGBA(16, 110, 190, 1)
        PressedFill: =RGBA(0, 120, 212, 1)
        SelectionColor: =RGBA(50, 49, 48, 1)
        SelectionFill: =RGBA(0, 120, 212, 1)
        Visible: =false
        X: =138
        Y: =642
        ZIndex: =7

    WorkDB_RegTypeDrpDown As dropdown:
        BorderColor: =RGBA(245, 245, 245, 1)
        ChevronBackground: =RGBA(245, 245, 245, 1)
        ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
        ChevronDisabledFill: =RGBA(161, 159, 157, 1)
        ChevronFill: =RGBA(50, 49, 48, 1)
        ChevronHoverBackground: =RGBA(245, 245, 245, 1)
        ChevronHoverFill: =RGBA(50, 49, 48, 1)
        Color: =RGBA(50, 49, 48, 1)
        Default: ="教員"
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(161, 159, 157, 1)
        DisabledFill: =RGBA(242, 242, 241, 0)
        Fill: =RGBA(245, 245, 245, 1)
        Font: =Font.'Segoe UI'
        HoverBorderColor: =RGBA(16, 110, 190, 1)
        HoverColor: =RGBA(50, 49, 48, 1)
        HoverFill: =RGBA(245, 245, 245, 1)
        Items: =Choices([@work_db].reg_type)
        PaddingBottom: =5
        PaddingLeft: =12
        PaddingRight: =5
        PaddingTop: =5
        PressedBorderColor: =RGBA(16, 110, 190, 1)
        PressedFill: =RGBA(0, 120, 212, 1)
        SelectionColor: =RGBA(50, 49, 48, 1)
        SelectionFill: =RGBA(0, 120, 212, 1)
        Visible: =false
        X: =138
        Y: =540
        ZIndex: =8

    Menu_bg_10 As rectangle:
        BorderColor: =RGBA(131, 24, 75, 1)
        Fill: =RGBA(0, 0, 0, 0.25)
        Height: =Parent.Height
        OnSelect: =Set(disp_menu, Not(disp_menu));
        Visible: =disp_menu
        Width: =App.Width
        ZIndex: =9

    Menu_9 As Menu:
        Approval: =Approval_Screen1
        CalcHoliday: =CalcHoliday_Screen1
        Calendar: =Calendar_Screen1
        Holiday: =Apply_Screen
        Home: =Home_Screen
        User: =User_Screen1
        Visible: =disp_menu
        ZIndex: =10

